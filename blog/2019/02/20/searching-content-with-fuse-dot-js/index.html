<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="theme-color" content="#252525"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="description" content="I&#x27;m a web developer in Norfolk. This is my blog..."><meta name="keywords" content="javascript,search,json"><link rel="amphtml" href="https://matthewdaly.co.uk/blog/2019/02/20/searching-content-with-fuse-dot-js/amp/"><meta http-equiv="Content-Security-Policy" content="default-src 'self'; child-src 'none'; frame-src disqus.com *.addthis.com; object-src 'none'; font-src 'self' fonts.google-apis.com fonts.gstatic.com; style-src 'self' fonts.googleapis.com *.addthis.com google-analytics.com *.disquscdn.com *.disqus.com 'unsafe-inline'; script-src 'self' localhost:* *.addthis.com *.google-analytics.com *.disquscdn.com *.disqus.com disqus.com *.addthisedge.com graph.facebook.com 'unsafe-inline' 'unsafe-eval'; connect-src 'self' ws://localhost:*; img-src 'self' *.google-analytics.com *.disquscdn.com *.disqus.com stats.g.doubleclick.net"><link rel="canonical" href="https://matthewdaly.co.uk/blog/2019/02/20/searching-content-with-fuse-dot-js/"><link href="/opensearch.xml" rel="search" title="Matthew Daly's Blog Search" type="application/opensearchdescription+xml"><link href="/favicon.ico" rel="icon"><link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=PT+Serif" media="all"><link rel="stylesheet" type="text/css" href="/static/css/style.min.css" media="all"><link rel="alternate" type="application/rss+xml" title="Matthew Daly&#x27;s Blog - feed" href="/rss.xml"><link rel="alternate" type="application/atom+xml" title="Matthew Daly&#x27;s Blog - feed" href="/atom.xml"><link rel="pingback" href="https://webmention.io/matthewdaly.co.uk/xmlrpc"><link rel="webmention" href="https://webmention.io/matthewdaly.co.uk/webmention"><title>Searching Content With Fuse.js - Matthew Daly&#x27;s Blog</title></head><body><script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=MattBD" async="async"></script><header><div class="container headercontainer"><div class="jumbotron"><h1><a href="/">Matthew Daly&#x27;s Blog</a></h1><h2>I&#x27;m a web developer in Norfolk. This is my blog...</h2></div></div><div class="container headercontainer"><nav class="navbar navbar-expand-lg navbar-dark bg-dark"><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav mr-auto"><li class="nav-item active"><a class="nav-link" href="/">Home <span class="sr-only">(current)</span></a></li><li class="nav-item active"><a class="nav-link" href="/blog/archives/">Archives</a></li><li class="nav-item active"><a class="nav-link" href="/about/">About</a></li><li class="nav-item active"><a class="nav-link" href="/uses/">Uses</a></li><li class="nav-item active"><a class="nav-link" href="/rss.xml">RSS</a></li><li class="nav-item dropdown d-lg-none"><div class="dropdown-menu" aria-labelledby="navbarDropdown"><a class="dropdown-item" href="/">Home</a> <a class="dropdown-item" href="/blog/archives/">Archives</a> <a class="dropdown-item" href="/about/">About</a> <a class="dropdown-item" href="/uses/">Uses</a> <a class="dropdown-item" href="/rss.xml">RSS</a></div></li></ul><form class="form-inline my-2 my-lg-0" action="https://www.google.com/search" method="GET" name="searchForm" id="searchForm" enctype="application/x-www-form-urlencoded"><input type="hidden" id="sitesearch" value="matthewdaly.co.uk"> <input class="form-control mr-sm-2" id="search" name="q" maxlength="200" autocomplete="off" type="search" placeholder="Search" aria-label="Search"><ul class="searchresults"></ul></form></div></nav></div></header><div id="mainbody" class="container"><div class="row"><div class="col-md-8"><article class="post"><p class="date">20th February 2019 5:25 pm</p><h1>Searching Content With Fuse.js</h1><p>Search is a problem I’m currently taking a big interest in. The legacy project I maintain has an utterly abominable search facility, one that I’m eager to replace with something like Elasticsearch. But smaller sites that are too small for Elasticsearch to be worth the bother can still benefit from having a decent search implementation. Despite some recent improvements, relational databases aren’t generally that good a fit for search because they don’t really understand the concept of relevance - you can’t easily order something by how good a match it is, and your database may not deal with fuzzy matching well.</p><p>I’m currently working on a small flat-file CMS as a personal project. It’s built with PHP, but it’s intended to be as simple as possible, with no database, no caching service, and certainly no search service, so it needs something small and simple, but still effective for search.</p><p>In the past I’ve used Lunr.js on my own site, and it works very well for this use case. However, it’s problematic for this case as the index needs to be generated in Javascript on the server side, and adding Node.js to the stack for a flat-file PHP CMS is not really an option. What I needed was something where I could generate the index in any language I chose, load it via AJAX, and search it on the client side. I recently happened to stumble across <a href="https://fusejs.io/">Fuse.js</a>, which was pretty much exactly what I was after.</p><p>Suppose we have the following index:</p><pre><code class="hljs lang-json"><table><tr><td class="linenos" data-pseudo-content="1"></td><td>[  </td></tr><tr><td class="linenos" data-pseudo-content="2"></td><td>   {  </td></tr><tr><td class="linenos" data-pseudo-content="3"></td><td>      <span class="hljs-attr">"title"</span>:<span class="hljs-string">"About me"</span>,</td></tr><tr><td class="linenos" data-pseudo-content="4"></td><td>      <span class="hljs-attr">"path"</span>:<span class="hljs-string">"about/"</span></td></tr><tr><td class="linenos" data-pseudo-content="5"></td><td>   },</td></tr><tr><td class="linenos" data-pseudo-content="6"></td><td>   {  </td></tr><tr><td class="linenos" data-pseudo-content="7"></td><td>      <span class="hljs-attr">"title"</span>:<span class="hljs-string">"Meet the team"</span>,</td></tr><tr><td class="linenos" data-pseudo-content="8"></td><td>      <span class="hljs-attr">"path"</span>:<span class="hljs-string">"about/meet-the-team/"</span></td></tr><tr><td class="linenos" data-pseudo-content="9"></td><td>   },</td></tr><tr><td class="linenos" data-pseudo-content="10"></td><td>   {  </td></tr><tr><td class="linenos" data-pseudo-content="11"></td><td>      <span class="hljs-attr">"title"</span>:<span class="hljs-string">"Alice"</span>,</td></tr><tr><td class="linenos" data-pseudo-content="12"></td><td>      <span class="hljs-attr">"path"</span>:<span class="hljs-string">"about/meet-the-team/alice/"</span></td></tr><tr><td class="linenos" data-pseudo-content="13"></td><td>   },</td></tr><tr><td class="linenos" data-pseudo-content="14"></td><td>   {  </td></tr><tr><td class="linenos" data-pseudo-content="15"></td><td>      <span class="hljs-attr">"title"</span>:<span class="hljs-string">"Bob"</span>,</td></tr><tr><td class="linenos" data-pseudo-content="16"></td><td>      <span class="hljs-attr">"path"</span>:<span class="hljs-string">"about/meet-the-team/bob/"</span></td></tr><tr><td class="linenos" data-pseudo-content="17"></td><td>   },</td></tr><tr><td class="linenos" data-pseudo-content="18"></td><td>   {  </td></tr><tr><td class="linenos" data-pseudo-content="19"></td><td>      <span class="hljs-attr">"title"</span>:<span class="hljs-string">"Chris"</span>,</td></tr><tr><td class="linenos" data-pseudo-content="20"></td><td>      <span class="hljs-attr">"path"</span>:<span class="hljs-string">"about/meet-the-team/chris/"</span></td></tr><tr><td class="linenos" data-pseudo-content="21"></td><td>   },</td></tr><tr><td class="linenos" data-pseudo-content="22"></td><td>   {  </td></tr><tr><td class="linenos" data-pseudo-content="23"></td><td>      <span class="hljs-attr">"title"</span>:<span class="hljs-string">"Home"</span>,</td></tr><tr><td class="linenos" data-pseudo-content="24"></td><td>      <span class="hljs-attr">"path"</span>:<span class="hljs-string">"index/"</span></td></tr><tr><td class="linenos" data-pseudo-content="25"></td><td>   }</td></tr><tr><td class="linenos" data-pseudo-content="26"></td><td>]</td></tr></table></code></pre><p>This index can be generated in any way you see fit. In this case, the page content is stored in Markdown files with YAML front matter, so I wrote a Symfony console command which gets all the Markdown files in the content folder, parses them to get the titles, and retrieves the path. You could also retrieve other items in front matter such as categories or tags, and the page content, and include that in the index. The data then gets converted to JSON and saved to the index file. As you can see, there’s nothing special about this JSON - these two fields happen to be the ones I’ve chosen.</p><p>Now we can load the JSON file via AJAX, and pass it to a new Fuse instance. You can search the index using the <code>.search()</code> method, as shown below:</p><pre><code class="hljs lang-javascript"><table><tr><td class="linenos" data-pseudo-content="1"></td><td><span class="hljs-keyword">import</span> Fuse <span class="hljs-keyword">from</span> <span class="hljs-string">'fuse.js'</span>;</td></tr><tr><td class="linenos" data-pseudo-content="2"></td><td><span class="hljs-built_in">window</span>.$ = <span class="hljs-built_in">window</span>.jQuery = <span class="hljs-built_in">require</span>(<span class="hljs-string">'jquery'</span>);</td></tr><tr><td class="linenos" data-pseudo-content="3"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="4"></td><td>$(<span class="hljs-built_in">document</span>).ready(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{</td></tr><tr><td class="linenos" data-pseudo-content="5"></td><td>  <span class="hljs-built_in">window</span>.$.getJSON(<span class="hljs-string">'/storage/index.json'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">response</span>) </span>{</td></tr><tr><td class="linenos" data-pseudo-content="6"></td><td>    <span class="hljs-keyword">const</span> fuse = <span class="hljs-keyword">new</span> Fuse(response, {</td></tr><tr><td class="linenos" data-pseudo-content="7"></td><td>      <span class="hljs-attr">keys</span>: [<span class="hljs-string">'title'</span>],</td></tr><tr><td class="linenos" data-pseudo-content="8"></td><td>      <span class="hljs-attr">shouldSort</span>: <span class="hljs-literal">true</span></td></tr><tr><td class="linenos" data-pseudo-content="9"></td><td>    });</td></tr><tr><td class="linenos" data-pseudo-content="10"></td><td>    $(<span class="hljs-string">'#search'</span>).on(<span class="hljs-string">'keyup'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{</td></tr><tr><td class="linenos" data-pseudo-content="11"></td><td>      <span class="hljs-keyword">let</span> result = fuse.search($(<span class="hljs-keyword">this</span>).val());</td></tr><tr><td class="linenos" data-pseudo-content="12"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="13"></td><td>      <span class="hljs-comment">// Output it</span></td></tr><tr><td class="linenos" data-pseudo-content="14"></td><td>      <span class="hljs-keyword">let</span> resultdiv = $(<span class="hljs-string">'ul.searchresults'</span>);</td></tr><tr><td class="linenos" data-pseudo-content="15"></td><td>      <span class="hljs-keyword">if</span> (result.length === <span class="hljs-number">0</span>) {</td></tr><tr><td class="linenos" data-pseudo-content="16"></td><td>        <span class="hljs-comment">// Hide results</span></td></tr><tr><td class="linenos" data-pseudo-content="17"></td><td>        resultdiv.hide();</td></tr><tr><td class="linenos" data-pseudo-content="18"></td><td>      } <span class="hljs-keyword">else</span> {</td></tr><tr><td class="linenos" data-pseudo-content="19"></td><td>        <span class="hljs-comment">// Show results</span></td></tr><tr><td class="linenos" data-pseudo-content="20"></td><td>        resultdiv.empty();</td></tr><tr><td class="linenos" data-pseudo-content="21"></td><td>        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> item <span class="hljs-keyword">in</span> result.slice(<span class="hljs-number">0</span>,<span class="hljs-number">4</span>)) {</td></tr><tr><td class="linenos" data-pseudo-content="22"></td><td>          <span class="hljs-keyword">let</span> searchitem = <span class="hljs-string">'&lt;li&gt;&lt;a href="/'</span> + result[item].path + <span class="hljs-string">'"&gt;'</span> + result[item].title + <span class="hljs-string">'&lt;/a&gt;&lt;/li&gt;'</span>;</td></tr><tr><td class="linenos" data-pseudo-content="23"></td><td>          resultdiv.append(searchitem);</td></tr><tr><td class="linenos" data-pseudo-content="24"></td><td>        }</td></tr><tr><td class="linenos" data-pseudo-content="25"></td><td>        resultdiv.show();</td></tr><tr><td class="linenos" data-pseudo-content="26"></td><td>      }</td></tr><tr><td class="linenos" data-pseudo-content="27"></td><td>    });</td></tr><tr><td class="linenos" data-pseudo-content="28"></td><td>  });</td></tr><tr><td class="linenos" data-pseudo-content="29"></td><td>});</td></tr></table></code></pre><p>The really great thing about Fuse.js is that it can search just about any JSON content, making it extremely flexible. For a site with a MySQL database, you could generate the JSON from one or more tables in the database, cache it in Redis or Memcached indefinitely until such time as the content changes again, and only regenerate it then, making for an extremely efficient client-side search that doesn’t need to hit the database during normal operation. Or you could generate it from static files, as in this example. It also means the backend language is not an issue, since you can easily generate the JSON file in PHP, Javascript, Python or any other language.</p><p>As you can see, it’s pretty straightforward to use Fuse.js to create a working search field out of the box, but the website lists a number of options allowing you to customise the search for your particular use case, and I’d recommend looking through these if you’re planning on using it on a project.</p><ul class="categorylist"><li><a href="/blog/categories/javascript/">javascript</a></li><li><a href="/blog/categories/search/">search</a></li><li><a href="/blog/categories/json/">json</a></li></ul><div class="addthis_sharing_toolbox"></div><section class="comments"><div id="disqus_thread"></div><script>var disqus_config = function () {
                        this.page.url = "https://matthewdaly.co.uk/blog/2019/02/20/searching-content-with-fuse-dot-js/";
                        this.page.identifier = "https://matthewdaly.co.uk/blog/2019/02/20/searching-content-with-fuse-dot-js/";
                     };
                  (function() { // DON'T EDIT BELOW THIS LINE
                     var d = document, s = d.createElement('script');
                     s.src = 'https://matthewdaly.disqus.com/embed.js';
                     s.setAttribute('data-timestamp', +new Date());
                     (d.head || d.body).appendChild(s);
                  })();</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></section></article></div><div class="col-md-4"><h1>Recent Posts</h1><p><a href="/blog/2019/10/27/input-components-with-the-usestate-and-useeffect-hooks-in-react/">Input Components With the Usestate and Useeffect Hooks in React</a></p><p><a href="/blog/2019/10/13/flexible-data-types-with-the-json-field/">Flexible Data Types With the JSON Field</a></p><p><a href="/blog/2019/09/22/storing-wordpress-configuration-in-environment-variables/">Storing Wordpress Configuration in Environment Variables</a></p><p><a href="/blog/2019/09/21/using-mix-versioning-outside-laravel/">Using Mix Versioning Outside Laravel</a></p><p><a href="/blog/2019/09/07/setting-private-properties-in-tests/">Setting Private Properties in Tests</a></p><section><h2>About me</h2><p>I'm a web and mobile app developer based in Norfolk. My skillset includes Python, PHP and Javascript, and I have extensive experience working with CodeIgniter, Laravel, Zend Framework, Django, Phonegap and React.js.</p></section><section id="links"><h2>Links</h2><a href="https://github.com/matthewbdaly" rel="me">GitHub</a> <a href="https://twitter.com/MattBD" rel="me">Twitter</a> <a href="http://stackoverflow.com/users/63717/matthew-daly">Stack Overflow</a> <a href="https://dev.to/matthewbdaly" rel="me">Dev.to</a></section></div></div><div class="row"><div class="col-md-12"><ul class="pagination"><li class="page-item"><a class="page-link" href="/blog/2019/02/16/higher-order-components-in-react/">&lt; Higher-order Components in React</a></li><li class="page-item"><a class="page-link" href="/blog/2019/03/04/how-much-difference-does-adding-an-index-to-a-database-table-make/">How Much Difference Does Adding An Index to a Database Table Make? &gt;</a></li></ul></div></div></div><footer><div class="container footercontainer"><div class="col-md-12"><p class="copyright">Copyright &copy; Matthew Daly 2019.</p></div></div></footer><script type="text/javascript" src="/static/js/all.min.js"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
            function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
            e=o.createElement(i);r=o.getElementsByTagName(i)[0];
            e.src='//www.google-analytics.com/analytics.js';
            r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
            ga('create','UA-17043630-1');ga('send','pageview');</script><script id="dsq-count-scr" src="//matthewdaly.disqus.com/count.js" async></script></body></html>