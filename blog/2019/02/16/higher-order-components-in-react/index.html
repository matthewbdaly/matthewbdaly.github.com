<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="theme-color" content="#252525"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="description" content="I&#x27;m a web developer in Norfolk. This is my blog..."><meta name="keywords" content="javascript,react"><link rel="amphtml" href="https://matthewdaly.co.uk/blog/2019/02/16/higher-order-components-in-react/amp/"><meta http-equiv="Content-Security-Policy" content="default-src 'self'; child-src 'none'; frame-src disqus.com *.addthis.com; object-src 'none'; font-src 'self' fonts.google-apis.com fonts.gstatic.com; style-src 'self' fonts.googleapis.com *.addthis.com google-analytics.com *.disquscdn.com *.disqus.com 'unsafe-inline'; script-src 'self' localhost:* *.addthis.com *.google-analytics.com *.disquscdn.com *.disqus.com disqus.com *.addthisedge.com graph.facebook.com 'unsafe-inline' 'unsafe-eval'; connect-src 'self' ws://localhost:*; img-src 'self' *.google-analytics.com *.disquscdn.com *.disqus.com stats.g.doubleclick.net"><link rel="canonical" href="https://matthewdaly.co.uk/blog/2019/02/16/higher-order-components-in-react/"><link href="/opensearch.xml" rel="search" title="Matthew Daly's Blog Search" type="application/opensearchdescription+xml"><link href="/favicon.ico" rel="icon"><link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=PT+Serif" media="all"><link rel="stylesheet" type="text/css" href="/static/css/style.min.css" media="all"><link rel="alternate" type="application/rss+xml" title="Matthew Daly&#x27;s Blog - feed" href="/rss.xml"><link rel="alternate" type="application/atom+xml" title="Matthew Daly&#x27;s Blog - feed" href="/atom.xml"><link rel="pingback" href="https://webmention.io/matthewdaly.co.uk/xmlrpc"><link rel="webmention" href="https://webmention.io/matthewdaly.co.uk/webmention"><title>Higher-order Components in React - Matthew Daly&#x27;s Blog</title></head><body><script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=MattBD" async="async"></script><header><div class="container headercontainer"><div class="jumbotron"><h1><a href="/">Matthew Daly&#x27;s Blog</a></h1><h2>I&#x27;m a web developer in Norfolk. This is my blog...</h2></div></div><div class="container headercontainer"><nav class="navbar navbar-expand-lg navbar-dark bg-dark"><button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav mr-auto"><li class="nav-item active"><a class="nav-link" href="/">Home <span class="sr-only">(current)</span></a></li><li class="nav-item active"><a class="nav-link" href="/blog/archives/">Archives</a></li><li class="nav-item active"><a class="nav-link" href="/about/">About</a></li><li class="nav-item active"><a class="nav-link" href="/uses/">Uses</a></li><li class="nav-item active"><a class="nav-link" href="/rss.xml">RSS</a></li><li class="nav-item dropdown d-lg-none"><div class="dropdown-menu" aria-labelledby="navbarDropdown"><a class="dropdown-item" href="/">Home</a> <a class="dropdown-item" href="/blog/archives/">Archives</a> <a class="dropdown-item" href="/about/">About</a> <a class="dropdown-item" href="/uses/">Uses</a> <a class="dropdown-item" href="/rss.xml">RSS</a></div></li></ul><form class="form-inline my-2 my-lg-0" action="https://www.google.com/search" method="GET" name="searchForm" id="searchForm" enctype="application/x-www-form-urlencoded"><input type="hidden" id="sitesearch" value="matthewdaly.co.uk"> <input class="form-control mr-sm-2" id="search" name="q" maxlength="200" autocomplete="off" type="search" placeholder="Search" aria-label="Search"><ul class="searchresults"></ul></form></div></nav></div></header><div id="mainbody" class="container"><div class="row"><div class="col-md-8"><article class="post"><p class="date">16th February 2019 7:00 pm</p><h1>Higher-order Components in React</h1><p>In the last few weeks I’ve been working on a big rebuild of the homepage of the legacy application I maintain. As I’ve been slowly transitioning it to use React on the front end, I used that, and it’s by far the largest React project I’ve worked on to date. This has pushed me to use some more advanced React techniques I hadn’t touched on before. I’ve also had to create some different components that have common functionality.</p><p>React used to use mixins to share common functionality, but the consensus is now that <a href="https://reactjs.org/blog/2016/07/13/mixins-considered-harmful.html">mixins are considered harmful</a>, so they have been removed. Instead, developers are encouraged to create higher-order components to contain the shared functionality.</p><p>A higher-order component is a function that accepts a React component as an argument, and then returns another component that wraps the provided one. The shared functionality is defined inside the wrapping component, and so any state or methods defined in the wrapping component can then be passed as props into the wrapped one, as in this simple example:</p><pre><code class="hljs lang-javascript"><table><tr><td class="linenos" data-pseudo-content="1"></td><td><span class="hljs-keyword">import</span> React, { Component } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;</td></tr><tr><td class="linenos" data-pseudo-content="2"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="3"></td><td><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hocExample</span>(<span class="hljs-params">WrappedComponent</span>) </span>{</td></tr><tr><td class="linenos" data-pseudo-content="4"></td><td>  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">hocExample</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{</td></tr><tr><td class="linenos" data-pseudo-content="5"></td><td>    <span class="hljs-keyword">constructor</span>(props) {</td></tr><tr><td class="linenos" data-pseudo-content="6"></td><td>      <span class="hljs-keyword">this</span>.state = {</td></tr><tr><td class="linenos" data-pseudo-content="7"></td><td>        <span class="hljs-attr">foo</span>: <span class="hljs-literal">false</span></td></tr><tr><td class="linenos" data-pseudo-content="8"></td><td>      };</td></tr><tr><td class="linenos" data-pseudo-content="9"></td><td>      <span class="hljs-keyword">this</span>.doStuff = <span class="hljs-keyword">this</span>.doStuff.bind(<span class="hljs-keyword">this</span>);</td></tr><tr><td class="linenos" data-pseudo-content="10"></td><td>    }</td></tr><tr><td class="linenos" data-pseudo-content="11"></td><td>    doStuff() {</td></tr><tr><td class="linenos" data-pseudo-content="12"></td><td>      <span class="hljs-keyword">this</span>.setState({</td></tr><tr><td class="linenos" data-pseudo-content="13"></td><td>        <span class="hljs-attr">foo</span>: <span class="hljs-literal">true</span></td></tr><tr><td class="linenos" data-pseudo-content="14"></td><td>      });</td></tr><tr><td class="linenos" data-pseudo-content="15"></td><td>    }</td></tr><tr><td class="linenos" data-pseudo-content="16"></td><td>    render() {</td></tr><tr><td class="linenos" data-pseudo-content="17"></td><td>      <span class="hljs-keyword">return</span> (</td></tr><tr><td class="linenos" data-pseudo-content="18"></td><td>        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">WrappedComponent</span> <span class="hljs-attr">foo</span>=<span class="hljs-string">{this.state.foo}</span> <span class="hljs-attr">doStuff</span>=<span class="hljs-string">{this.doStuff}</span> /&gt;</span></span></td></tr><tr><td class="linenos" data-pseudo-content="19"></td><td>      );</td></tr><tr><td class="linenos" data-pseudo-content="20"></td><td>    }</td></tr><tr><td class="linenos" data-pseudo-content="21"></td><td>  }</td></tr><tr><td class="linenos" data-pseudo-content="22"></td><td>  return hocExample;</td></tr><tr><td class="linenos" data-pseudo-content="23"></td><td>}</td></tr></table></code></pre><p>If you’ve been working with React for a while, even if you haven’t written a higher-order component, you’ve probably used one. For instance, <code>withRouter()</code> from <code>react-router</code> is a good example of a higher-order component that forms part of an existing library.</p><h1 id="a-real-world-example">A real-world example</h1><p>A very common use case I’ve come across is handling a click outside of a component. For instance, if you have a sidebar or popup component, it’s common to want to close it when the user clicks outside the component. As such, it’s worth taking the time to refactor it to make it reusable.</p><p>In principle you can achieve this on any component as follows:</p><ul><li>The component should accept two props - an <code>active</code> prop that denotes whether the component is active or not, and an <code>onClickOutside()</code> prop method that is called on a click outside</li><li>On mount, an event listener should be added to the document to listen for <code>mousedown</code> events, and it should be removed on unmount</li><li>When the event listener is fired, it should use a ref on the component to determine if the ref contains the event target. If so, and the status is active, the <code>onClickOutside()</code> method should be called</li></ul><p>Moving this to a higher order component makes a couple of issues slightly more complex, but not very. We can’t easily get a ref of the wrapped component, so I had to resort to using <code>ReactDOM.findDOMNode()</code> instead, which is potentially a bit dodgy as they’re talking about deprecating that.</p><pre><code class="hljs lang-javascript"><table><tr><td class="linenos" data-pseudo-content="1"></td><td><span class="hljs-keyword">import</span> React, { Component } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;</td></tr><tr><td class="linenos" data-pseudo-content="2"></td><td><span class="hljs-keyword">import</span> { findDOMNode } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-dom'</span>;</td></tr><tr><td class="linenos" data-pseudo-content="3"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="4"></td><td><span class="hljs-keyword">export</span> <span class="hljs-keyword">default</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">clicksOutside</span>(<span class="hljs-params">WrappedComponent</span>) </span>{</td></tr><tr><td class="linenos" data-pseudo-content="5"></td><td>  <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">clicksOutside</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{</td></tr><tr><td class="linenos" data-pseudo-content="6"></td><td>    <span class="hljs-keyword">constructor</span>(props) {</td></tr><tr><td class="linenos" data-pseudo-content="7"></td><td>      <span class="hljs-keyword">super</span>(props);</td></tr><tr><td class="linenos" data-pseudo-content="8"></td><td>      <span class="hljs-keyword">this</span>.setWrapperRef = <span class="hljs-keyword">this</span>.setWrapperRef.bind(<span class="hljs-keyword">this</span>);</td></tr><tr><td class="linenos" data-pseudo-content="9"></td><td>      <span class="hljs-keyword">this</span>.handleClickOutside = <span class="hljs-keyword">this</span>.handleClickOutside.bind(<span class="hljs-keyword">this</span>);</td></tr><tr><td class="linenos" data-pseudo-content="10"></td><td>    }</td></tr><tr><td class="linenos" data-pseudo-content="11"></td><td>    componentDidMount() {</td></tr><tr><td class="linenos" data-pseudo-content="12"></td><td>      <span class="hljs-built_in">document</span>.addEventListener(<span class="hljs-string">'mousedown'</span>, <span class="hljs-keyword">this</span>.handleClickOutside);</td></tr><tr><td class="linenos" data-pseudo-content="13"></td><td>    }</td></tr><tr><td class="linenos" data-pseudo-content="14"></td><td>    componentWillUnmount() {</td></tr><tr><td class="linenos" data-pseudo-content="15"></td><td>      <span class="hljs-built_in">document</span>.removeEventListener(<span class="hljs-string">'mousedown'</span>, <span class="hljs-keyword">this</span>.handleClickOutside);</td></tr><tr><td class="linenos" data-pseudo-content="16"></td><td>    }</td></tr><tr><td class="linenos" data-pseudo-content="17"></td><td>    setWrapperRef(node) {</td></tr><tr><td class="linenos" data-pseudo-content="18"></td><td>      <span class="hljs-keyword">this</span>.wrapperRef = node;</td></tr><tr><td class="linenos" data-pseudo-content="19"></td><td>    }</td></tr><tr><td class="linenos" data-pseudo-content="20"></td><td>    handleClickOutside(event) {</td></tr><tr><td class="linenos" data-pseudo-content="21"></td><td>      <span class="hljs-keyword">const</span> {target} = event;</td></tr><tr><td class="linenos" data-pseudo-content="22"></td><td>      <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.wrapperRef &amp;&amp; target <span class="hljs-keyword">instanceof</span> Node) {</td></tr><tr><td class="linenos" data-pseudo-content="23"></td><td>        <span class="hljs-keyword">const</span> ref = findDOMNode(<span class="hljs-keyword">this</span>.wrapperRef);</td></tr><tr><td class="linenos" data-pseudo-content="24"></td><td>        <span class="hljs-keyword">if</span> (ref &amp;&amp; !ref.contains(target) &amp;&amp; <span class="hljs-keyword">this</span>.props.active === <span class="hljs-literal">true</span>) {</td></tr><tr><td class="linenos" data-pseudo-content="25"></td><td>          <span class="hljs-keyword">this</span>.props.onClickOutside();</td></tr><tr><td class="linenos" data-pseudo-content="26"></td><td>        }</td></tr><tr><td class="linenos" data-pseudo-content="27"></td><td>      }</td></tr><tr><td class="linenos" data-pseudo-content="28"></td><td>    }</td></tr><tr><td class="linenos" data-pseudo-content="29"></td><td>    render() {</td></tr><tr><td class="linenos" data-pseudo-content="30"></td><td>      <span class="hljs-keyword">return</span> (</td></tr><tr><td class="linenos" data-pseudo-content="31"></td><td>        <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">WrappedComponent</span> {<span class="hljs-attr">...this.props</span>} <span class="hljs-attr">ref</span>=<span class="hljs-string">{this.setWrapperRef}</span> /&gt;</span></span></td></tr><tr><td class="linenos" data-pseudo-content="32"></td><td>      );</td></tr><tr><td class="linenos" data-pseudo-content="33"></td><td>    }</td></tr><tr><td class="linenos" data-pseudo-content="34"></td><td>  };</td></tr><tr><td class="linenos" data-pseudo-content="35"></td><td>  return clicksOutside;</td></tr><tr><td class="linenos" data-pseudo-content="36"></td><td>}</td></tr></table></code></pre><p>Now we can use this as follows:</p><pre><code class="hljs lang-javascript"><table><tr><td class="linenos" data-pseudo-content="1"></td><td><span class="hljs-keyword">import</span> React, { Component } <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;</td></tr><tr><td class="linenos" data-pseudo-content="2"></td><td><span class="hljs-keyword">import</span> ReactDOM <span class="hljs-keyword">from</span> <span class="hljs-string">'react-dom'</span>;</td></tr><tr><td class="linenos" data-pseudo-content="3"></td><td><span class="hljs-keyword">import</span> Sidebar <span class="hljs-keyword">from</span> <span class="hljs-string">'./src/Components/Sidebar'</span>;</td></tr><tr><td class="linenos" data-pseudo-content="4"></td><td><span class="hljs-keyword">import</span> clicksOutside <span class="hljs-keyword">from</span> <span class="hljs-string">'./src/Components/clicksOutside'</span>;</td></tr><tr><td class="linenos" data-pseudo-content="5"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="6"></td><td><span class="hljs-keyword">const</span> SidebarComponent = clicksOutside(Sidebar);</td></tr><tr><td class="linenos" data-pseudo-content="7"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="8"></td><td><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">handleClickOutside</span>(<span class="hljs-params"></span>) </span>{</td></tr><tr><td class="linenos" data-pseudo-content="9"></td><td>  alert(<span class="hljs-string">'You have clicked outside'</span>);</td></tr><tr><td class="linenos" data-pseudo-content="10"></td><td>}</td></tr><tr><td class="linenos" data-pseudo-content="11"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="12"></td><td>ReactDOM.render(</td></tr><tr><td class="linenos" data-pseudo-content="13"></td><td>  <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">SidebarComponent</span> </span></span></td></tr><tr><td class="linenos" data-pseudo-content="14"></td><td>    <span class="hljs-attr">links</span>=<span class="hljs-string">{links}</span> </td></tr><tr><td class="linenos" data-pseudo-content="15"></td><td>    <span class="hljs-attr">active</span>=<span class="hljs-string">{true}</span> </td></tr><tr><td class="linenos" data-pseudo-content="16"></td><td>    <span class="hljs-attr">onClickOutside</span>=<span class="hljs-string">{handleClickOutside}</span> </td></tr><tr><td class="linenos" data-pseudo-content="17"></td><td>  /&gt;,</td></tr><tr><td class="linenos" data-pseudo-content="18"></td><td>  document.getElementById('root')</td></tr><tr><td class="linenos" data-pseudo-content="19"></td><td>);</td></tr></table></code></pre><p>Higher order components sound a lot harder than they actually are. In reality, they’re actually quite simple to implement, but I’m not sure the <a href="https://reactjs.org/docs/higher-order-components.html">documentation</a> is necessarily the best example to use since it’s a bit on the complex side.</p><ul class="categorylist"><li><a href="/blog/categories/javascript/">javascript</a></li><li><a href="/blog/categories/react/">react</a></li></ul><div class="addthis_sharing_toolbox"></div><section class="comments"><div id="disqus_thread"></div><script>var disqus_config = function () {
                        this.page.url = "https://matthewdaly.co.uk/blog/2019/02/16/higher-order-components-in-react/";
                        this.page.identifier = "https://matthewdaly.co.uk/blog/2019/02/16/higher-order-components-in-react/";
                     };
                  (function() { // DON'T EDIT BELOW THIS LINE
                     var d = document, s = d.createElement('script');
                     s.src = 'https://matthewdaly.disqus.com/embed.js';
                     s.setAttribute('data-timestamp', +new Date());
                     (d.head || d.body).appendChild(s);
                  })();</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></section></article></div><div class="col-md-4"><h1>Recent Posts</h1><p><a href="/blog/2020/01/25/f***-phpstorm-man-and-the-high-horse-he-rode-in-on/">F*** Phpstorm Man and the High Horse He Rode in on</a></p><p><a href="/blog/2019/10/27/input-components-with-the-usestate-and-useeffect-hooks-in-react/">Input Components With the Usestate and Useeffect Hooks in React</a></p><p><a href="/blog/2019/10/13/flexible-data-types-with-the-json-field/">Flexible Data Types With the JSON Field</a></p><p><a href="/blog/2019/09/22/storing-wordpress-configuration-in-environment-variables/">Storing Wordpress Configuration in Environment Variables</a></p><p><a href="/blog/2019/09/21/using-mix-versioning-outside-laravel/">Using Mix Versioning Outside Laravel</a></p><section><h2>About me</h2><p>I'm a web and mobile app developer based in Norfolk. My skillset includes Python, PHP and Javascript, and I have extensive experience working with CodeIgniter, Laravel, Zend Framework, Django, Phonegap and React.js.</p></section><section id="links"><h2>Links</h2><a href="https://github.com/matthewbdaly" rel="me">GitHub</a> <a href="https://twitter.com/MattBD" rel="me">Twitter</a> <a href="http://stackoverflow.com/users/63717/matthew-daly">Stack Overflow</a> <a href="https://dev.to/matthewbdaly" rel="me">Dev.to</a></section></div></div><div class="row"><div class="col-md-12"><ul class="pagination"><li class="page-item"><a class="page-link" href="/blog/2019/02/02/creating-your-own-dependency-injection-container-in-php/">&lt; Creating Your Own Dependency Injection Container in PHP</a></li><li class="page-item"><a class="page-link" href="/blog/2019/02/20/searching-content-with-fuse-dot-js/">Searching Content With Fuse.js &gt;</a></li></ul></div></div></div><footer><div class="container footercontainer"><div class="col-md-12"><p class="copyright">Copyright &copy; Matthew Daly 2020.</p></div></div></footer><script type="text/javascript" src="/static/js/all.min.js"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
            function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
            e=o.createElement(i);r=o.getElementsByTagName(i)[0];
            e.src='//www.google-analytics.com/analytics.js';
            r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
            ga('create','UA-17043630-1');ga('send','pageview');</script><script id="dsq-count-scr" src="//matthewdaly.disqus.com/count.js" async></script></body></html>