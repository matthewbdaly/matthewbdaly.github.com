<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="theme-color" content="#252525"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0"><meta name="description" content="I&#x27;m a web developer in Norfolk. This is my blog..."><meta name="keywords" content="tdd,python,django,django-blog-tutorial"><link rel="amphtml" href="https://matthewdaly.co.uk/blog/2014/09/28/django-blog-tutorial-the-next-generation-part-9/amp/"><link rel="canonical" href="https://matthewdaly.co.uk/blog/2014/09/28/django-blog-tutorial-the-next-generation-part-9/"><link href="/opensearch.xml" rel="search" title="Matthew Daly's Blog Search" type="application/opensearchdescription+xml"><link href="/favicon.ico" rel="icon"><link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="stylesheet" type="text/css" href="/static/css/style.min.css" media="all"><link rel="alternate" type="application/rss+xml" title="Matthew Daly&#x27;s Blog - feed" href="/rss.xml"><link rel="alternate" type="application/atom+xml" title="Matthew Daly&#x27;s Blog - feed" href="/atom.xml"><link rel="pingback" href="https://webmention.io/matthewdaly.co.uk/xmlrpc"><link rel="webmention" href="https://webmention.io/matthewdaly.co.uk/webmention"><title>Django Blog Tutorial - the Next Generation - Part 9 - Matthew Daly&#x27;s Blog</title></head><body><script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=MattBD" async="async"></script><header><div class="container headercontainer"><div class="jumbotron"><h1><a href="/">Matthew Daly&#x27;s Blog</a></h1><h2>I&#x27;m a web developer in Norfolk. This is my blog...</h2></div></div><div class="container headercontainer"><nav class="navbar navbar-inverse navbar-static-top"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#header-nav"><span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button><div class="collapse navbar-collapse" id="header-nav"><ul class="nav navbar-nav"><li><a href="/">Home</a></li><li><a href="/blog/archives/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="/rss.xml">RSS</a></li></ul><form action="https://www.google.com/search" method="GET" name="searchForm" id="searchForm" enctype="application/x-www-form-urlencoded" class="navbar-form navbar-right"><div class="form-group"><input type="hidden" id="sitesearch" value="matthewdaly.co.uk"> <input id="search" type="search" name="q" placeholder="Search..." maxlength="200" autocomplete="off" class="form-control"><ul class="searchresults"></ul></div></form></div></div></nav></div></header><div id="mainbody" class="container"><div class="row"><div class="col-md-8"><article class="post"><p class="date">28th September 2014 8:51 pm</p><h1>Django Blog Tutorial - the Next Generation - Part 9</h1><p>Yes, I know the eight instalment was meant to be the last one! Within 24 hours of that post going live, Django 1.7 was released, so naturally I’d like to show you how to upgrade to it.</p><p>The biggest change is that Django 1.7 introduces its own migration system, which means South is now surplus to requirements. We therefore need to switch from South to Django’s native migrations. Fortunately, this is fairly straightforward.</p><p>First of all, activate your virtualenv:</p><pre><code class="hljs lang-bash singleline">$ virtualenv venv</code></pre><p>Then make sure your migrations are up to date:</p><pre><code class="hljs lang-bash"><table><tr><td class="linenos" data-pseudo-content="1"></td><td>$ python manage.py syncdb</td></tr><tr><td class="linenos" data-pseudo-content="2"></td><td>$ python manage.py migrate</td></tr></table></code></pre><p>Then, upgrade your Django version and uninstall South:</p><pre><code class="hljs lang-bash"><table><tr><td class="linenos" data-pseudo-content="1"></td><td>$ pip install Django --upgrade</td></tr><tr><td class="linenos" data-pseudo-content="2"></td><td>$ pip uninstall South</td></tr><tr><td class="linenos" data-pseudo-content="3"></td><td>$ pip freeze &gt; requirements.txt</td></tr></table></code></pre><p>Next, remove South from <code>INSTALLED_APPS</code> in <code>django_tutorial_blog_ng/settings.py</code>.</p><p>You now need to delete all of the numbered migration files in <code>blogengine/migrations/</code>, and the relevant <code>.pyc</code> files, but NOT the directory or the <code>__init__.py</code> file. You can do so with this command on Linux or OS X:</p><pre><code class="hljs lang-bash singleline">$ rm blogengine/migrations/00*</code></pre><p>Next, we recreate our migrations with the following command:</p><pre><code class="hljs lang-bash"><table><tr><td class="linenos" data-pseudo-content="1"></td><td>$ python manage.py makemigrations</td></tr><tr><td class="linenos" data-pseudo-content="2"></td><td>Migrations <span class="hljs-keyword">for</span> <span class="hljs-string">'blogengine'</span>:</td></tr><tr><td class="linenos" data-pseudo-content="3"></td><td>  0001_initial.py:</td></tr><tr><td class="linenos" data-pseudo-content="4"></td><td>    - Create model Category</td></tr><tr><td class="linenos" data-pseudo-content="5"></td><td>    - Create model Post</td></tr><tr><td class="linenos" data-pseudo-content="6"></td><td>    - Create model Tag</td></tr><tr><td class="linenos" data-pseudo-content="7"></td><td>    - Add field tags to post</td></tr></table></code></pre><p>Then we run the migrations:</p><pre><code class="hljs lang-bash"><table><tr><td class="linenos" data-pseudo-content="1"></td><td>$ python manage.py migrate</td></tr><tr><td class="linenos" data-pseudo-content="2"></td><td>Operations to perform:</td></tr><tr><td class="linenos" data-pseudo-content="3"></td><td>  Synchronize unmigrated apps: sitemaps, django_jenkins, debug_toolbar</td></tr><tr><td class="linenos" data-pseudo-content="4"></td><td>  Apply all migrations: sessions, admin, sites, flatpages, contenttypes, auth, blogengine</td></tr><tr><td class="linenos" data-pseudo-content="5"></td><td>Synchronizing apps without migrations:</td></tr><tr><td class="linenos" data-pseudo-content="6"></td><td>  Creating tables...</td></tr><tr><td class="linenos" data-pseudo-content="7"></td><td>  Installing custom SQL...</td></tr><tr><td class="linenos" data-pseudo-content="8"></td><td>  Installing indexes...</td></tr><tr><td class="linenos" data-pseudo-content="9"></td><td>Running migrations:</td></tr><tr><td class="linenos" data-pseudo-content="10"></td><td>  Applying contenttypes.0001_initial... FAKED</td></tr><tr><td class="linenos" data-pseudo-content="11"></td><td>  Applying auth.0001_initial... FAKED</td></tr><tr><td class="linenos" data-pseudo-content="12"></td><td>  Applying admin.0001_initial... FAKED</td></tr><tr><td class="linenos" data-pseudo-content="13"></td><td>  Applying sites.0001_initial... FAKED</td></tr><tr><td class="linenos" data-pseudo-content="14"></td><td>  Applying blogengine.0001_initial... FAKED</td></tr><tr><td class="linenos" data-pseudo-content="15"></td><td>  Applying flatpages.0001_initial... FAKED</td></tr><tr><td class="linenos" data-pseudo-content="16"></td><td>  Applying sessions.0001_initial... FAKED</td></tr></table></code></pre><p>Don’t worry too much if the output doesn’t look exactly the same as this - as long as it works, that’s the main thing.</p><p>Let’s run our test suite to ensure it works:</p><pre><code class="hljs lang-bash"><table><tr><td class="linenos" data-pseudo-content="1"></td><td>$ python manage.py jenkins</td></tr><tr><td class="linenos" data-pseudo-content="2"></td><td>Creating <span class="hljs-built_in">test</span> database <span class="hljs-keyword">for</span> <span class="hljs-built_in">alias</span> <span class="hljs-string">'default'</span>...</td></tr><tr><td class="linenos" data-pseudo-content="3"></td><td>....FF.F.FFFFFF..............</td></tr><tr><td class="linenos" data-pseudo-content="4"></td><td>======================================================================</td></tr><tr><td class="linenos" data-pseudo-content="5"></td><td>FAIL: test_create_post (blogengine.tests.AdminTest)</td></tr><tr><td class="linenos" data-pseudo-content="6"></td><td>----------------------------------------------------------------------</td></tr><tr><td class="linenos" data-pseudo-content="7"></td><td>Traceback (most recent call last):</td></tr><tr><td class="linenos" data-pseudo-content="8"></td><td>  File <span class="hljs-string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 385, <span class="hljs-keyword">in</span> test_create_post</td></tr><tr><td class="linenos" data-pseudo-content="9"></td><td>    self.assertTrue(<span class="hljs-string">'added successfully'</span> <span class="hljs-keyword">in</span> response.content)</td></tr><tr><td class="linenos" data-pseudo-content="10"></td><td>AssertionError: False is not <span class="hljs-literal">true</span></td></tr><tr><td class="linenos" data-pseudo-content="11"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="12"></td><td>======================================================================</td></tr><tr><td class="linenos" data-pseudo-content="13"></td><td>FAIL: test_create_post_without_tag (blogengine.tests.AdminTest)</td></tr><tr><td class="linenos" data-pseudo-content="14"></td><td>----------------------------------------------------------------------</td></tr><tr><td class="linenos" data-pseudo-content="15"></td><td>Traceback (most recent call last):</td></tr><tr><td class="linenos" data-pseudo-content="16"></td><td>  File <span class="hljs-string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 417, <span class="hljs-keyword">in</span> test_create_post_without_tag</td></tr><tr><td class="linenos" data-pseudo-content="17"></td><td>    self.assertTrue(<span class="hljs-string">'added successfully'</span> <span class="hljs-keyword">in</span> response.content)</td></tr><tr><td class="linenos" data-pseudo-content="18"></td><td>AssertionError: False is not <span class="hljs-literal">true</span></td></tr><tr><td class="linenos" data-pseudo-content="19"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="20"></td><td>======================================================================</td></tr><tr><td class="linenos" data-pseudo-content="21"></td><td>FAIL: test_delete_category (blogengine.tests.AdminTest)</td></tr><tr><td class="linenos" data-pseudo-content="22"></td><td>----------------------------------------------------------------------</td></tr><tr><td class="linenos" data-pseudo-content="23"></td><td>Traceback (most recent call last):</td></tr><tr><td class="linenos" data-pseudo-content="24"></td><td>  File <span class="hljs-string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 278, <span class="hljs-keyword">in</span> test_delete_category</td></tr><tr><td class="linenos" data-pseudo-content="25"></td><td>    self.assertEquals(response.status_code, 200)</td></tr><tr><td class="linenos" data-pseudo-content="26"></td><td>AssertionError: 404 != 200</td></tr><tr><td class="linenos" data-pseudo-content="27"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="28"></td><td>======================================================================</td></tr><tr><td class="linenos" data-pseudo-content="29"></td><td>FAIL: test_delete_tag (blogengine.tests.AdminTest)</td></tr><tr><td class="linenos" data-pseudo-content="30"></td><td>----------------------------------------------------------------------</td></tr><tr><td class="linenos" data-pseudo-content="31"></td><td>Traceback (most recent call last):</td></tr><tr><td class="linenos" data-pseudo-content="32"></td><td>  File <span class="hljs-string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 346, <span class="hljs-keyword">in</span> test_delete_tag</td></tr><tr><td class="linenos" data-pseudo-content="33"></td><td>    self.assertEquals(response.status_code, 200)</td></tr><tr><td class="linenos" data-pseudo-content="34"></td><td>AssertionError: 404 != 200</td></tr><tr><td class="linenos" data-pseudo-content="35"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="36"></td><td>======================================================================</td></tr><tr><td class="linenos" data-pseudo-content="37"></td><td>FAIL: test_edit_category (blogengine.tests.AdminTest)</td></tr><tr><td class="linenos" data-pseudo-content="38"></td><td>----------------------------------------------------------------------</td></tr><tr><td class="linenos" data-pseudo-content="39"></td><td>Traceback (most recent call last):</td></tr><tr><td class="linenos" data-pseudo-content="40"></td><td>  File <span class="hljs-string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 255, <span class="hljs-keyword">in</span> test_edit_category</td></tr><tr><td class="linenos" data-pseudo-content="41"></td><td>    self.assertEquals(response.status_code, 200)</td></tr><tr><td class="linenos" data-pseudo-content="42"></td><td>AssertionError: 404 != 200</td></tr><tr><td class="linenos" data-pseudo-content="43"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="44"></td><td>======================================================================</td></tr><tr><td class="linenos" data-pseudo-content="45"></td><td>FAIL: test_edit_post (blogengine.tests.AdminTest)</td></tr><tr><td class="linenos" data-pseudo-content="46"></td><td>----------------------------------------------------------------------</td></tr><tr><td class="linenos" data-pseudo-content="47"></td><td>Traceback (most recent call last):</td></tr><tr><td class="linenos" data-pseudo-content="48"></td><td>  File <span class="hljs-string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 447, <span class="hljs-keyword">in</span> test_edit_post</td></tr><tr><td class="linenos" data-pseudo-content="49"></td><td>    self.assertEquals(response.status_code, 200)</td></tr><tr><td class="linenos" data-pseudo-content="50"></td><td>AssertionError: 404 != 200</td></tr><tr><td class="linenos" data-pseudo-content="51"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="52"></td><td>======================================================================</td></tr><tr><td class="linenos" data-pseudo-content="53"></td><td>FAIL: test_edit_tag (blogengine.tests.AdminTest)</td></tr><tr><td class="linenos" data-pseudo-content="54"></td><td>----------------------------------------------------------------------</td></tr><tr><td class="linenos" data-pseudo-content="55"></td><td>Traceback (most recent call last):</td></tr><tr><td class="linenos" data-pseudo-content="56"></td><td>  File <span class="hljs-string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 323, <span class="hljs-keyword">in</span> test_edit_tag</td></tr><tr><td class="linenos" data-pseudo-content="57"></td><td>    self.assertEquals(response.status_code, 200)</td></tr><tr><td class="linenos" data-pseudo-content="58"></td><td>AssertionError: 404 != 200</td></tr><tr><td class="linenos" data-pseudo-content="59"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="60"></td><td>======================================================================</td></tr><tr><td class="linenos" data-pseudo-content="61"></td><td>FAIL: test_login (blogengine.tests.AdminTest)</td></tr><tr><td class="linenos" data-pseudo-content="62"></td><td>----------------------------------------------------------------------</td></tr><tr><td class="linenos" data-pseudo-content="63"></td><td>Traceback (most recent call last):</td></tr><tr><td class="linenos" data-pseudo-content="64"></td><td>  File <span class="hljs-string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 183, <span class="hljs-keyword">in</span> test_login</td></tr><tr><td class="linenos" data-pseudo-content="65"></td><td>    self.assertEquals(response.status_code, 200)</td></tr><tr><td class="linenos" data-pseudo-content="66"></td><td>AssertionError: 302 != 200</td></tr><tr><td class="linenos" data-pseudo-content="67"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="68"></td><td>======================================================================</td></tr><tr><td class="linenos" data-pseudo-content="69"></td><td>FAIL: test_logout (blogengine.tests.AdminTest)</td></tr><tr><td class="linenos" data-pseudo-content="70"></td><td>----------------------------------------------------------------------</td></tr><tr><td class="linenos" data-pseudo-content="71"></td><td>Traceback (most recent call last):</td></tr><tr><td class="linenos" data-pseudo-content="72"></td><td>  File <span class="hljs-string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 214, <span class="hljs-keyword">in</span> test_logout</td></tr><tr><td class="linenos" data-pseudo-content="73"></td><td>    self.assertEquals(response.status_code, 200)</td></tr><tr><td class="linenos" data-pseudo-content="74"></td><td>AssertionError: 302 != 200</td></tr><tr><td class="linenos" data-pseudo-content="75"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="76"></td><td>----------------------------------------------------------------------</td></tr><tr><td class="linenos" data-pseudo-content="77"></td><td>Ran 29 tests <span class="hljs-keyword">in</span> 7.383s</td></tr><tr><td class="linenos" data-pseudo-content="78"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="79"></td><td>FAILED (failures=9)</td></tr><tr><td class="linenos" data-pseudo-content="80"></td><td>Destroying <span class="hljs-built_in">test</span> database <span class="hljs-keyword">for</span> <span class="hljs-built_in">alias</span> <span class="hljs-string">'default'</span>...</td></tr></table></code></pre><p>We have an issue here. A load of the tests for the admin interface now fail. If we now try running the dev server, we see this error:</p><pre><code class="hljs lang-bash"><table><tr><td class="linenos" data-pseudo-content="1"></td><td>$ python manage.py runserver</td></tr><tr><td class="linenos" data-pseudo-content="2"></td><td>Performing system checks...</td></tr><tr><td class="linenos" data-pseudo-content="3"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="4"></td><td>System check identified no issues (0 silenced).</td></tr><tr><td class="linenos" data-pseudo-content="5"></td><td>September 28, 2014 - 20:16:47</td></tr><tr><td class="linenos" data-pseudo-content="6"></td><td>Django version 1.7, using settings <span class="hljs-string">'django_tutorial_blog_ng.settings'</span></td></tr><tr><td class="linenos" data-pseudo-content="7"></td><td>Starting development server at http://127.0.0.1:8000/</td></tr><tr><td class="linenos" data-pseudo-content="8"></td><td>Quit the server with CONTROL-C.</td></tr><tr><td class="linenos" data-pseudo-content="9"></td><td>Unhandled exception <span class="hljs-keyword">in</span> thread started by &lt;<span class="hljs-keyword">function</span> wrapper at 0x1024a5ed8&gt;</td></tr><tr><td class="linenos" data-pseudo-content="10"></td><td>Traceback (most recent call last):</td></tr><tr><td class="linenos" data-pseudo-content="11"></td><td>  File <span class="hljs-string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/utils/autoreload.py"</span>, line 222, <span class="hljs-keyword">in</span> wrapper</td></tr><tr><td class="linenos" data-pseudo-content="12"></td><td>    fn(*args, **kwargs)</td></tr><tr><td class="linenos" data-pseudo-content="13"></td><td>  File <span class="hljs-string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/core/management/commands/runserver.py"</span>, line 132, <span class="hljs-keyword">in</span> inner_run</td></tr><tr><td class="linenos" data-pseudo-content="14"></td><td>    handler = self.get_handler(*args, **options)</td></tr><tr><td class="linenos" data-pseudo-content="15"></td><td>  File <span class="hljs-string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/contrib/staticfiles/management/commands/runserver.py"</span>, line 25, <span class="hljs-keyword">in</span> get_handler</td></tr><tr><td class="linenos" data-pseudo-content="16"></td><td>    handler = super(Command, self).get_handler(*args, **options)</td></tr><tr><td class="linenos" data-pseudo-content="17"></td><td>  File <span class="hljs-string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/core/management/commands/runserver.py"</span>, line 48, <span class="hljs-keyword">in</span> get_handler</td></tr><tr><td class="linenos" data-pseudo-content="18"></td><td>    <span class="hljs-built_in">return</span> get_internal_wsgi_application()</td></tr><tr><td class="linenos" data-pseudo-content="19"></td><td>  File <span class="hljs-string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/core/servers/basehttp.py"</span>, line 66, <span class="hljs-keyword">in</span> get_internal_wsgi_application</td></tr><tr><td class="linenos" data-pseudo-content="20"></td><td>    sys.exc_info()[2])</td></tr><tr><td class="linenos" data-pseudo-content="21"></td><td>  File <span class="hljs-string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/core/servers/basehttp.py"</span>, line 56, <span class="hljs-keyword">in</span> get_internal_wsgi_application</td></tr><tr><td class="linenos" data-pseudo-content="22"></td><td>    <span class="hljs-built_in">return</span> import_string(app_path)</td></tr><tr><td class="linenos" data-pseudo-content="23"></td><td>  File <span class="hljs-string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/django/utils/module_loading.py"</span>, line 26, <span class="hljs-keyword">in</span> import_string</td></tr><tr><td class="linenos" data-pseudo-content="24"></td><td>    module = import_module(module_path)</td></tr><tr><td class="linenos" data-pseudo-content="25"></td><td>  File <span class="hljs-string">"/usr/local/Cellar/python/2.7.8_1/Frameworks/Python.framework/Versions/2.7/lib/python2.7/importlib/__init__.py"</span>, line 37, <span class="hljs-keyword">in</span> import_module</td></tr><tr><td class="linenos" data-pseudo-content="26"></td><td>    __import__(name)</td></tr><tr><td class="linenos" data-pseudo-content="27"></td><td>  File <span class="hljs-string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/django_tutorial_blog_ng/wsgi.py"</span>, line 14, <span class="hljs-keyword">in</span> &lt;module&gt;</td></tr><tr><td class="linenos" data-pseudo-content="28"></td><td>    from dj_static import Cling</td></tr><tr><td class="linenos" data-pseudo-content="29"></td><td>  File <span class="hljs-string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/venv/lib/python2.7/site-packages/dj_static.py"</span>, line 7, <span class="hljs-keyword">in</span> &lt;module&gt;</td></tr><tr><td class="linenos" data-pseudo-content="30"></td><td>    from django.core.handlers.base import get_path_info</td></tr><tr><td class="linenos" data-pseudo-content="31"></td><td>django.core.exceptions.ImproperlyConfigured: WSGI application <span class="hljs-string">'django_tutorial_blog_ng.wsgi.application'</span> could not be loaded; Error importing module: <span class="hljs-string">'cannot import name get_path_info'</span></td></tr></table></code></pre><p>Fortunately, the error above is easy to fix by upgrading <code>dj_static</code>:</p><pre><code class="hljs lang-bash"><table><tr><td class="linenos" data-pseudo-content="1"></td><td>$ pip install dj_static --upgrade</td></tr><tr><td class="linenos" data-pseudo-content="2"></td><td>$ pip freeze &gt; requirements.txt</td></tr></table></code></pre><p>That resolves the error in serving static files, but not the error with the admin. If you run the dev server, you’ll be able to see that the admin actually works fine. The problem is caused by the test client not following redirects in the admin. We can easily run just the admin tests with the following command:</p><pre><code class="hljs lang-bash"><table><tr><td class="linenos" data-pseudo-content="1"></td><td>$ python manage.py <span class="hljs-built_in">test</span> blogengine.tests.AdminTest</td></tr><tr><td class="linenos" data-pseudo-content="2"></td><td>Creating <span class="hljs-built_in">test</span> database <span class="hljs-keyword">for</span> <span class="hljs-built_in">alias</span> <span class="hljs-string">'default'</span>...</td></tr><tr><td class="linenos" data-pseudo-content="3"></td><td>.FF.F.FFFFFF</td></tr><tr><td class="linenos" data-pseudo-content="4"></td><td>======================================================================</td></tr><tr><td class="linenos" data-pseudo-content="5"></td><td>FAIL: test_create_post (blogengine.tests.AdminTest)</td></tr><tr><td class="linenos" data-pseudo-content="6"></td><td>----------------------------------------------------------------------</td></tr><tr><td class="linenos" data-pseudo-content="7"></td><td>Traceback (most recent call last):</td></tr><tr><td class="linenos" data-pseudo-content="8"></td><td>  File <span class="hljs-string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 385, <span class="hljs-keyword">in</span> test_create_post</td></tr><tr><td class="linenos" data-pseudo-content="9"></td><td>    self.assertTrue(<span class="hljs-string">'added successfully'</span> <span class="hljs-keyword">in</span> response.content)</td></tr><tr><td class="linenos" data-pseudo-content="10"></td><td>AssertionError: False is not <span class="hljs-literal">true</span></td></tr><tr><td class="linenos" data-pseudo-content="11"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="12"></td><td>======================================================================</td></tr><tr><td class="linenos" data-pseudo-content="13"></td><td>FAIL: test_create_post_without_tag (blogengine.tests.AdminTest)</td></tr><tr><td class="linenos" data-pseudo-content="14"></td><td>----------------------------------------------------------------------</td></tr><tr><td class="linenos" data-pseudo-content="15"></td><td>Traceback (most recent call last):</td></tr><tr><td class="linenos" data-pseudo-content="16"></td><td>  File <span class="hljs-string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 417, <span class="hljs-keyword">in</span> test_create_post_without_tag</td></tr><tr><td class="linenos" data-pseudo-content="17"></td><td>    self.assertTrue(<span class="hljs-string">'added successfully'</span> <span class="hljs-keyword">in</span> response.content)</td></tr><tr><td class="linenos" data-pseudo-content="18"></td><td>AssertionError: False is not <span class="hljs-literal">true</span></td></tr><tr><td class="linenos" data-pseudo-content="19"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="20"></td><td>======================================================================</td></tr><tr><td class="linenos" data-pseudo-content="21"></td><td>FAIL: test_delete_category (blogengine.tests.AdminTest)</td></tr><tr><td class="linenos" data-pseudo-content="22"></td><td>----------------------------------------------------------------------</td></tr><tr><td class="linenos" data-pseudo-content="23"></td><td>Traceback (most recent call last):</td></tr><tr><td class="linenos" data-pseudo-content="24"></td><td>  File <span class="hljs-string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 278, <span class="hljs-keyword">in</span> test_delete_category</td></tr><tr><td class="linenos" data-pseudo-content="25"></td><td>    self.assertEquals(response.status_code, 200)</td></tr><tr><td class="linenos" data-pseudo-content="26"></td><td>AssertionError: 404 != 200</td></tr><tr><td class="linenos" data-pseudo-content="27"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="28"></td><td>======================================================================</td></tr><tr><td class="linenos" data-pseudo-content="29"></td><td>FAIL: test_delete_tag (blogengine.tests.AdminTest)</td></tr><tr><td class="linenos" data-pseudo-content="30"></td><td>----------------------------------------------------------------------</td></tr><tr><td class="linenos" data-pseudo-content="31"></td><td>Traceback (most recent call last):</td></tr><tr><td class="linenos" data-pseudo-content="32"></td><td>  File <span class="hljs-string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 346, <span class="hljs-keyword">in</span> test_delete_tag</td></tr><tr><td class="linenos" data-pseudo-content="33"></td><td>    self.assertEquals(response.status_code, 200)</td></tr><tr><td class="linenos" data-pseudo-content="34"></td><td>AssertionError: 404 != 200</td></tr><tr><td class="linenos" data-pseudo-content="35"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="36"></td><td>======================================================================</td></tr><tr><td class="linenos" data-pseudo-content="37"></td><td>FAIL: test_edit_category (blogengine.tests.AdminTest)</td></tr><tr><td class="linenos" data-pseudo-content="38"></td><td>----------------------------------------------------------------------</td></tr><tr><td class="linenos" data-pseudo-content="39"></td><td>Traceback (most recent call last):</td></tr><tr><td class="linenos" data-pseudo-content="40"></td><td>  File <span class="hljs-string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 255, <span class="hljs-keyword">in</span> test_edit_category</td></tr><tr><td class="linenos" data-pseudo-content="41"></td><td>    self.assertEquals(response.status_code, 200)</td></tr><tr><td class="linenos" data-pseudo-content="42"></td><td>AssertionError: 404 != 200</td></tr><tr><td class="linenos" data-pseudo-content="43"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="44"></td><td>======================================================================</td></tr><tr><td class="linenos" data-pseudo-content="45"></td><td>FAIL: test_edit_post (blogengine.tests.AdminTest)</td></tr><tr><td class="linenos" data-pseudo-content="46"></td><td>----------------------------------------------------------------------</td></tr><tr><td class="linenos" data-pseudo-content="47"></td><td>Traceback (most recent call last):</td></tr><tr><td class="linenos" data-pseudo-content="48"></td><td>  File <span class="hljs-string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 447, <span class="hljs-keyword">in</span> test_edit_post</td></tr><tr><td class="linenos" data-pseudo-content="49"></td><td>    self.assertEquals(response.status_code, 200)</td></tr><tr><td class="linenos" data-pseudo-content="50"></td><td>AssertionError: 404 != 200</td></tr><tr><td class="linenos" data-pseudo-content="51"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="52"></td><td>======================================================================</td></tr><tr><td class="linenos" data-pseudo-content="53"></td><td>FAIL: test_edit_tag (blogengine.tests.AdminTest)</td></tr><tr><td class="linenos" data-pseudo-content="54"></td><td>----------------------------------------------------------------------</td></tr><tr><td class="linenos" data-pseudo-content="55"></td><td>Traceback (most recent call last):</td></tr><tr><td class="linenos" data-pseudo-content="56"></td><td>  File <span class="hljs-string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 323, <span class="hljs-keyword">in</span> test_edit_tag</td></tr><tr><td class="linenos" data-pseudo-content="57"></td><td>    self.assertEquals(response.status_code, 200)</td></tr><tr><td class="linenos" data-pseudo-content="58"></td><td>AssertionError: 404 != 200</td></tr><tr><td class="linenos" data-pseudo-content="59"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="60"></td><td>======================================================================</td></tr><tr><td class="linenos" data-pseudo-content="61"></td><td>FAIL: test_login (blogengine.tests.AdminTest)</td></tr><tr><td class="linenos" data-pseudo-content="62"></td><td>----------------------------------------------------------------------</td></tr><tr><td class="linenos" data-pseudo-content="63"></td><td>Traceback (most recent call last):</td></tr><tr><td class="linenos" data-pseudo-content="64"></td><td>  File <span class="hljs-string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 183, <span class="hljs-keyword">in</span> test_login</td></tr><tr><td class="linenos" data-pseudo-content="65"></td><td>    self.assertEquals(response.status_code, 200)</td></tr><tr><td class="linenos" data-pseudo-content="66"></td><td>AssertionError: 302 != 200</td></tr><tr><td class="linenos" data-pseudo-content="67"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="68"></td><td>======================================================================</td></tr><tr><td class="linenos" data-pseudo-content="69"></td><td>FAIL: test_logout (blogengine.tests.AdminTest)</td></tr><tr><td class="linenos" data-pseudo-content="70"></td><td>----------------------------------------------------------------------</td></tr><tr><td class="linenos" data-pseudo-content="71"></td><td>Traceback (most recent call last):</td></tr><tr><td class="linenos" data-pseudo-content="72"></td><td>  File <span class="hljs-string">"/Users/matthewdaly/Projects/django_tutorial_blog_ng/blogengine/tests.py"</span>, line 214, <span class="hljs-keyword">in</span> test_logout</td></tr><tr><td class="linenos" data-pseudo-content="73"></td><td>    self.assertEquals(response.status_code, 200)</td></tr><tr><td class="linenos" data-pseudo-content="74"></td><td>AssertionError: 302 != 200</td></tr><tr><td class="linenos" data-pseudo-content="75"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="76"></td><td>----------------------------------------------------------------------</td></tr><tr><td class="linenos" data-pseudo-content="77"></td><td>Ran 12 tests <span class="hljs-keyword">in</span> 3.283s</td></tr><tr><td class="linenos" data-pseudo-content="78"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="79"></td><td>FAILED (failures=9)</td></tr><tr><td class="linenos" data-pseudo-content="80"></td><td>Destroying <span class="hljs-built_in">test</span> database <span class="hljs-keyword">for</span> <span class="hljs-built_in">alias</span> <span class="hljs-string">'default'</span>...</td></tr></table></code></pre><p>Let’s commit our changes so far first:</p><pre><code class="hljs lang-bash"><table><tr><td class="linenos" data-pseudo-content="1"></td><td>$ git add django_tutorial_blog_ng/ requirements.txt blogengine/</td></tr><tr><td class="linenos" data-pseudo-content="2"></td><td>$ git commit -m <span class="hljs-string">'Upgraded to Django 1.7'</span></td></tr></table></code></pre><p>Now let’s fix our tests. Here’s the amended version of the <code>AdminTest</code> class:</p><pre><code class="hljs lang-python"><table><tr><td class="linenos" data-pseudo-content="1"></td><td><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AdminTest</span><span class="hljs-params">(BaseAcceptanceTest)</span>:</span></td></tr><tr><td class="linenos" data-pseudo-content="2"></td><td>    fixtures = [<span class="hljs-string">'users.json'</span>]</td></tr><tr><td class="linenos" data-pseudo-content="3"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="4"></td><td>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_login</span><span class="hljs-params">(self)</span>:</span></td></tr><tr><td class="linenos" data-pseudo-content="5"></td><td>        <span class="hljs-comment"># Get login page</span></td></tr><tr><td class="linenos" data-pseudo-content="6"></td><td>        response = self.client.get(<span class="hljs-string">'/admin/'</span>, follow=<span class="hljs-keyword">True</span>)</td></tr><tr><td class="linenos" data-pseudo-content="7"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="8"></td><td>        <span class="hljs-comment"># Check response code</span></td></tr><tr><td class="linenos" data-pseudo-content="9"></td><td>        self.assertEquals(response.status_code, <span class="hljs-number">200</span>)</td></tr><tr><td class="linenos" data-pseudo-content="10"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="11"></td><td>        <span class="hljs-comment"># Check 'Log in' in response</span></td></tr><tr><td class="linenos" data-pseudo-content="12"></td><td>        self.assertTrue(<span class="hljs-string">'Log in'</span> <span class="hljs-keyword">in</span> response.content)</td></tr><tr><td class="linenos" data-pseudo-content="13"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="14"></td><td>        <span class="hljs-comment"># Log the user in</span></td></tr><tr><td class="linenos" data-pseudo-content="15"></td><td>        self.client.login(username=<span class="hljs-string">'bobsmith'</span>, password=<span class="hljs-string">"password"</span>)</td></tr><tr><td class="linenos" data-pseudo-content="16"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="17"></td><td>        <span class="hljs-comment"># Check response code</span></td></tr><tr><td class="linenos" data-pseudo-content="18"></td><td>        response = self.client.get(<span class="hljs-string">'/admin/'</span>)</td></tr><tr><td class="linenos" data-pseudo-content="19"></td><td>        self.assertEquals(response.status_code, <span class="hljs-number">200</span>)</td></tr><tr><td class="linenos" data-pseudo-content="20"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="21"></td><td>        <span class="hljs-comment"># Check 'Log out' in response</span></td></tr><tr><td class="linenos" data-pseudo-content="22"></td><td>        self.assertTrue(<span class="hljs-string">'Log out'</span> <span class="hljs-keyword">in</span> response.content)</td></tr><tr><td class="linenos" data-pseudo-content="23"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="24"></td><td>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_logout</span><span class="hljs-params">(self)</span>:</span></td></tr><tr><td class="linenos" data-pseudo-content="25"></td><td>        <span class="hljs-comment"># Log in</span></td></tr><tr><td class="linenos" data-pseudo-content="26"></td><td>        self.client.login(username=<span class="hljs-string">'bobsmith'</span>, password=<span class="hljs-string">"password"</span>)</td></tr><tr><td class="linenos" data-pseudo-content="27"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="28"></td><td>        <span class="hljs-comment"># Check response code</span></td></tr><tr><td class="linenos" data-pseudo-content="29"></td><td>        response = self.client.get(<span class="hljs-string">'/admin/'</span>)</td></tr><tr><td class="linenos" data-pseudo-content="30"></td><td>        self.assertEquals(response.status_code, <span class="hljs-number">200</span>)</td></tr><tr><td class="linenos" data-pseudo-content="31"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="32"></td><td>        <span class="hljs-comment"># Check 'Log out' in response</span></td></tr><tr><td class="linenos" data-pseudo-content="33"></td><td>        self.assertTrue(<span class="hljs-string">'Log out'</span> <span class="hljs-keyword">in</span> response.content)</td></tr><tr><td class="linenos" data-pseudo-content="34"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="35"></td><td>        <span class="hljs-comment"># Log out</span></td></tr><tr><td class="linenos" data-pseudo-content="36"></td><td>        self.client.logout()</td></tr><tr><td class="linenos" data-pseudo-content="37"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="38"></td><td>        <span class="hljs-comment"># Check response code</span></td></tr><tr><td class="linenos" data-pseudo-content="39"></td><td>        response = self.client.get(<span class="hljs-string">'/admin/'</span>, follow=<span class="hljs-keyword">True</span>)</td></tr><tr><td class="linenos" data-pseudo-content="40"></td><td>        self.assertEquals(response.status_code, <span class="hljs-number">200</span>)</td></tr><tr><td class="linenos" data-pseudo-content="41"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="42"></td><td>        <span class="hljs-comment"># Check 'Log in' in response</span></td></tr><tr><td class="linenos" data-pseudo-content="43"></td><td>        self.assertTrue(<span class="hljs-string">'Log in'</span> <span class="hljs-keyword">in</span> response.content)</td></tr><tr><td class="linenos" data-pseudo-content="44"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="45"></td><td>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_create_category</span><span class="hljs-params">(self)</span>:</span></td></tr><tr><td class="linenos" data-pseudo-content="46"></td><td>        <span class="hljs-comment"># Log in</span></td></tr><tr><td class="linenos" data-pseudo-content="47"></td><td>        self.client.login(username=<span class="hljs-string">'bobsmith'</span>, password=<span class="hljs-string">"password"</span>)</td></tr><tr><td class="linenos" data-pseudo-content="48"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="49"></td><td>        <span class="hljs-comment"># Check response code</span></td></tr><tr><td class="linenos" data-pseudo-content="50"></td><td>        response = self.client.get(<span class="hljs-string">'/admin/blogengine/category/add/'</span>)</td></tr><tr><td class="linenos" data-pseudo-content="51"></td><td>        self.assertEquals(response.status_code, <span class="hljs-number">200</span>)</td></tr><tr><td class="linenos" data-pseudo-content="52"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="53"></td><td>        <span class="hljs-comment"># Create the new category</span></td></tr><tr><td class="linenos" data-pseudo-content="54"></td><td>        response = self.client.post(<span class="hljs-string">'/admin/blogengine/category/add/'</span>, {</td></tr><tr><td class="linenos" data-pseudo-content="55"></td><td>            <span class="hljs-string">'name'</span>: <span class="hljs-string">'python'</span>,</td></tr><tr><td class="linenos" data-pseudo-content="56"></td><td>            <span class="hljs-string">'description'</span>: <span class="hljs-string">'The Python programming language'</span></td></tr><tr><td class="linenos" data-pseudo-content="57"></td><td>            },</td></tr><tr><td class="linenos" data-pseudo-content="58"></td><td>            follow=<span class="hljs-keyword">True</span></td></tr><tr><td class="linenos" data-pseudo-content="59"></td><td>        )</td></tr><tr><td class="linenos" data-pseudo-content="60"></td><td>        self.assertEquals(response.status_code, <span class="hljs-number">200</span>)</td></tr><tr><td class="linenos" data-pseudo-content="61"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="62"></td><td>        <span class="hljs-comment"># Check added successfully</span></td></tr><tr><td class="linenos" data-pseudo-content="63"></td><td>        self.assertTrue(<span class="hljs-string">'added successfully'</span> <span class="hljs-keyword">in</span> response.content)</td></tr><tr><td class="linenos" data-pseudo-content="64"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="65"></td><td>        <span class="hljs-comment"># Check new category now in database</span></td></tr><tr><td class="linenos" data-pseudo-content="66"></td><td>        all_categories = Category.objects.all()</td></tr><tr><td class="linenos" data-pseudo-content="67"></td><td>        self.assertEquals(len(all_categories), <span class="hljs-number">1</span>)</td></tr><tr><td class="linenos" data-pseudo-content="68"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="69"></td><td>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_edit_category</span><span class="hljs-params">(self)</span>:</span></td></tr><tr><td class="linenos" data-pseudo-content="70"></td><td>        <span class="hljs-comment"># Create the category</span></td></tr><tr><td class="linenos" data-pseudo-content="71"></td><td>        category = CategoryFactory()</td></tr><tr><td class="linenos" data-pseudo-content="72"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="73"></td><td>        <span class="hljs-comment"># Log in</span></td></tr><tr><td class="linenos" data-pseudo-content="74"></td><td>        self.client.login(username=<span class="hljs-string">'bobsmith'</span>, password=<span class="hljs-string">"password"</span>)</td></tr><tr><td class="linenos" data-pseudo-content="75"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="76"></td><td>        <span class="hljs-comment"># Edit the category</span></td></tr><tr><td class="linenos" data-pseudo-content="77"></td><td>        response = self.client.post(<span class="hljs-string">'/admin/blogengine/category/'</span> + str(category.pk) + <span class="hljs-string">'/'</span>, {</td></tr><tr><td class="linenos" data-pseudo-content="78"></td><td>            <span class="hljs-string">'name'</span>: <span class="hljs-string">'perl'</span>,</td></tr><tr><td class="linenos" data-pseudo-content="79"></td><td>            <span class="hljs-string">'description'</span>: <span class="hljs-string">'The Perl programming language'</span></td></tr><tr><td class="linenos" data-pseudo-content="80"></td><td>            }, follow=<span class="hljs-keyword">True</span>)</td></tr><tr><td class="linenos" data-pseudo-content="81"></td><td>        self.assertEquals(response.status_code, <span class="hljs-number">200</span>)</td></tr><tr><td class="linenos" data-pseudo-content="82"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="83"></td><td>        <span class="hljs-comment"># Check changed successfully</span></td></tr><tr><td class="linenos" data-pseudo-content="84"></td><td>        self.assertTrue(<span class="hljs-string">'changed successfully'</span> <span class="hljs-keyword">in</span> response.content)</td></tr><tr><td class="linenos" data-pseudo-content="85"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="86"></td><td>        <span class="hljs-comment"># Check category amended</span></td></tr><tr><td class="linenos" data-pseudo-content="87"></td><td>        all_categories = Category.objects.all()</td></tr><tr><td class="linenos" data-pseudo-content="88"></td><td>        self.assertEquals(len(all_categories), <span class="hljs-number">1</span>)</td></tr><tr><td class="linenos" data-pseudo-content="89"></td><td>        only_category = all_categories[<span class="hljs-number">0</span>]</td></tr><tr><td class="linenos" data-pseudo-content="90"></td><td>        self.assertEquals(only_category.name, <span class="hljs-string">'perl'</span>)</td></tr><tr><td class="linenos" data-pseudo-content="91"></td><td>        self.assertEquals(only_category.description, <span class="hljs-string">'The Perl programming language'</span>)</td></tr><tr><td class="linenos" data-pseudo-content="92"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="93"></td><td>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_delete_category</span><span class="hljs-params">(self)</span>:</span></td></tr><tr><td class="linenos" data-pseudo-content="94"></td><td>        <span class="hljs-comment"># Create the category</span></td></tr><tr><td class="linenos" data-pseudo-content="95"></td><td>        category = CategoryFactory()</td></tr><tr><td class="linenos" data-pseudo-content="96"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="97"></td><td>        <span class="hljs-comment"># Log in</span></td></tr><tr><td class="linenos" data-pseudo-content="98"></td><td>        self.client.login(username=<span class="hljs-string">'bobsmith'</span>, password=<span class="hljs-string">"password"</span>)</td></tr><tr><td class="linenos" data-pseudo-content="99"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="100"></td><td>        <span class="hljs-comment"># Delete the category</span></td></tr><tr><td class="linenos" data-pseudo-content="101"></td><td>        response = self.client.post(<span class="hljs-string">'/admin/blogengine/category/'</span> + str(category.pk) + <span class="hljs-string">'/delete/'</span>, {</td></tr><tr><td class="linenos" data-pseudo-content="102"></td><td>            <span class="hljs-string">'post'</span>: <span class="hljs-string">'yes'</span></td></tr><tr><td class="linenos" data-pseudo-content="103"></td><td>        }, follow=<span class="hljs-keyword">True</span>)</td></tr><tr><td class="linenos" data-pseudo-content="104"></td><td>        self.assertEquals(response.status_code, <span class="hljs-number">200</span>)</td></tr><tr><td class="linenos" data-pseudo-content="105"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="106"></td><td>        <span class="hljs-comment"># Check deleted successfully</span></td></tr><tr><td class="linenos" data-pseudo-content="107"></td><td>        self.assertTrue(<span class="hljs-string">'deleted successfully'</span> <span class="hljs-keyword">in</span> response.content)</td></tr><tr><td class="linenos" data-pseudo-content="108"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="109"></td><td>        <span class="hljs-comment"># Check category deleted</span></td></tr><tr><td class="linenos" data-pseudo-content="110"></td><td>        all_categories = Category.objects.all()</td></tr><tr><td class="linenos" data-pseudo-content="111"></td><td>        self.assertEquals(len(all_categories), <span class="hljs-number">0</span>)</td></tr><tr><td class="linenos" data-pseudo-content="112"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="113"></td><td>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_create_tag</span><span class="hljs-params">(self)</span>:</span></td></tr><tr><td class="linenos" data-pseudo-content="114"></td><td>        <span class="hljs-comment"># Log in</span></td></tr><tr><td class="linenos" data-pseudo-content="115"></td><td>        self.client.login(username=<span class="hljs-string">'bobsmith'</span>, password=<span class="hljs-string">"password"</span>)</td></tr><tr><td class="linenos" data-pseudo-content="116"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="117"></td><td>        <span class="hljs-comment"># Check response code</span></td></tr><tr><td class="linenos" data-pseudo-content="118"></td><td>        response = self.client.get(<span class="hljs-string">'/admin/blogengine/tag/add/'</span>)</td></tr><tr><td class="linenos" data-pseudo-content="119"></td><td>        self.assertEquals(response.status_code, <span class="hljs-number">200</span>)</td></tr><tr><td class="linenos" data-pseudo-content="120"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="121"></td><td>        <span class="hljs-comment"># Create the new tag</span></td></tr><tr><td class="linenos" data-pseudo-content="122"></td><td>        response = self.client.post(<span class="hljs-string">'/admin/blogengine/tag/add/'</span>, {</td></tr><tr><td class="linenos" data-pseudo-content="123"></td><td>            <span class="hljs-string">'name'</span>: <span class="hljs-string">'python'</span>,</td></tr><tr><td class="linenos" data-pseudo-content="124"></td><td>            <span class="hljs-string">'description'</span>: <span class="hljs-string">'The Python programming language'</span></td></tr><tr><td class="linenos" data-pseudo-content="125"></td><td>            },</td></tr><tr><td class="linenos" data-pseudo-content="126"></td><td>            follow=<span class="hljs-keyword">True</span></td></tr><tr><td class="linenos" data-pseudo-content="127"></td><td>        )</td></tr><tr><td class="linenos" data-pseudo-content="128"></td><td>        self.assertEquals(response.status_code, <span class="hljs-number">200</span>)</td></tr><tr><td class="linenos" data-pseudo-content="129"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="130"></td><td>        <span class="hljs-comment"># Check added successfully</span></td></tr><tr><td class="linenos" data-pseudo-content="131"></td><td>        self.assertTrue(<span class="hljs-string">'added successfully'</span> <span class="hljs-keyword">in</span> response.content)</td></tr><tr><td class="linenos" data-pseudo-content="132"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="133"></td><td>        <span class="hljs-comment"># Check new tag now in database</span></td></tr><tr><td class="linenos" data-pseudo-content="134"></td><td>        all_tags = Tag.objects.all()</td></tr><tr><td class="linenos" data-pseudo-content="135"></td><td>        self.assertEquals(len(all_tags), <span class="hljs-number">1</span>)</td></tr><tr><td class="linenos" data-pseudo-content="136"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="137"></td><td>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_edit_tag</span><span class="hljs-params">(self)</span>:</span></td></tr><tr><td class="linenos" data-pseudo-content="138"></td><td>        <span class="hljs-comment"># Create the tag</span></td></tr><tr><td class="linenos" data-pseudo-content="139"></td><td>        tag = TagFactory()</td></tr><tr><td class="linenos" data-pseudo-content="140"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="141"></td><td>        <span class="hljs-comment"># Log in</span></td></tr><tr><td class="linenos" data-pseudo-content="142"></td><td>        self.client.login(username=<span class="hljs-string">'bobsmith'</span>, password=<span class="hljs-string">"password"</span>)</td></tr><tr><td class="linenos" data-pseudo-content="143"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="144"></td><td>        <span class="hljs-comment"># Edit the tag</span></td></tr><tr><td class="linenos" data-pseudo-content="145"></td><td>        response = self.client.post(<span class="hljs-string">'/admin/blogengine/tag/'</span> + str(tag.pk) + <span class="hljs-string">'/'</span>, {</td></tr><tr><td class="linenos" data-pseudo-content="146"></td><td>            <span class="hljs-string">'name'</span>: <span class="hljs-string">'perl'</span>,</td></tr><tr><td class="linenos" data-pseudo-content="147"></td><td>            <span class="hljs-string">'description'</span>: <span class="hljs-string">'The Perl programming language'</span></td></tr><tr><td class="linenos" data-pseudo-content="148"></td><td>            }, follow=<span class="hljs-keyword">True</span>)</td></tr><tr><td class="linenos" data-pseudo-content="149"></td><td>        self.assertEquals(response.status_code, <span class="hljs-number">200</span>)</td></tr><tr><td class="linenos" data-pseudo-content="150"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="151"></td><td>        <span class="hljs-comment"># Check changed successfully</span></td></tr><tr><td class="linenos" data-pseudo-content="152"></td><td>        self.assertTrue(<span class="hljs-string">'changed successfully'</span> <span class="hljs-keyword">in</span> response.content)</td></tr><tr><td class="linenos" data-pseudo-content="153"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="154"></td><td>        <span class="hljs-comment"># Check tag amended</span></td></tr><tr><td class="linenos" data-pseudo-content="155"></td><td>        all_tags = Tag.objects.all()</td></tr><tr><td class="linenos" data-pseudo-content="156"></td><td>        self.assertEquals(len(all_tags), <span class="hljs-number">1</span>)</td></tr><tr><td class="linenos" data-pseudo-content="157"></td><td>        only_tag = all_tags[<span class="hljs-number">0</span>]</td></tr><tr><td class="linenos" data-pseudo-content="158"></td><td>        self.assertEquals(only_tag.name, <span class="hljs-string">'perl'</span>)</td></tr><tr><td class="linenos" data-pseudo-content="159"></td><td>        self.assertEquals(only_tag.description, <span class="hljs-string">'The Perl programming language'</span>)</td></tr><tr><td class="linenos" data-pseudo-content="160"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="161"></td><td>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_delete_tag</span><span class="hljs-params">(self)</span>:</span></td></tr><tr><td class="linenos" data-pseudo-content="162"></td><td>        <span class="hljs-comment"># Create the tag</span></td></tr><tr><td class="linenos" data-pseudo-content="163"></td><td>        tag = TagFactory()</td></tr><tr><td class="linenos" data-pseudo-content="164"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="165"></td><td>        <span class="hljs-comment"># Log in</span></td></tr><tr><td class="linenos" data-pseudo-content="166"></td><td>        self.client.login(username=<span class="hljs-string">'bobsmith'</span>, password=<span class="hljs-string">"password"</span>)</td></tr><tr><td class="linenos" data-pseudo-content="167"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="168"></td><td>        <span class="hljs-comment"># Delete the tag</span></td></tr><tr><td class="linenos" data-pseudo-content="169"></td><td>        response = self.client.post(<span class="hljs-string">'/admin/blogengine/tag/'</span> + str(tag.pk) + <span class="hljs-string">'/delete/'</span>, {</td></tr><tr><td class="linenos" data-pseudo-content="170"></td><td>            <span class="hljs-string">'post'</span>: <span class="hljs-string">'yes'</span></td></tr><tr><td class="linenos" data-pseudo-content="171"></td><td>        }, follow=<span class="hljs-keyword">True</span>)</td></tr><tr><td class="linenos" data-pseudo-content="172"></td><td>        self.assertEquals(response.status_code, <span class="hljs-number">200</span>)</td></tr><tr><td class="linenos" data-pseudo-content="173"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="174"></td><td>        <span class="hljs-comment"># Check deleted successfully</span></td></tr><tr><td class="linenos" data-pseudo-content="175"></td><td>        self.assertTrue(<span class="hljs-string">'deleted successfully'</span> <span class="hljs-keyword">in</span> response.content)</td></tr><tr><td class="linenos" data-pseudo-content="176"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="177"></td><td>        <span class="hljs-comment"># Check tag deleted</span></td></tr><tr><td class="linenos" data-pseudo-content="178"></td><td>        all_tags = Tag.objects.all()</td></tr><tr><td class="linenos" data-pseudo-content="179"></td><td>        self.assertEquals(len(all_tags), <span class="hljs-number">0</span>)</td></tr><tr><td class="linenos" data-pseudo-content="180"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="181"></td><td>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_create_post</span><span class="hljs-params">(self)</span>:</span></td></tr><tr><td class="linenos" data-pseudo-content="182"></td><td>        <span class="hljs-comment"># Create the category</span></td></tr><tr><td class="linenos" data-pseudo-content="183"></td><td>        category = CategoryFactory()</td></tr><tr><td class="linenos" data-pseudo-content="184"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="185"></td><td>        <span class="hljs-comment"># Create the tag</span></td></tr><tr><td class="linenos" data-pseudo-content="186"></td><td>        tag = TagFactory()</td></tr><tr><td class="linenos" data-pseudo-content="187"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="188"></td><td>        <span class="hljs-comment"># Log in</span></td></tr><tr><td class="linenos" data-pseudo-content="189"></td><td>        self.client.login(username=<span class="hljs-string">'bobsmith'</span>, password=<span class="hljs-string">"password"</span>)</td></tr><tr><td class="linenos" data-pseudo-content="190"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="191"></td><td>        <span class="hljs-comment"># Check response code</span></td></tr><tr><td class="linenos" data-pseudo-content="192"></td><td>        response = self.client.get(<span class="hljs-string">'/admin/blogengine/post/add/'</span>)</td></tr><tr><td class="linenos" data-pseudo-content="193"></td><td>        self.assertEquals(response.status_code, <span class="hljs-number">200</span>)</td></tr><tr><td class="linenos" data-pseudo-content="194"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="195"></td><td>        <span class="hljs-comment"># Create the new post</span></td></tr><tr><td class="linenos" data-pseudo-content="196"></td><td>        response = self.client.post(<span class="hljs-string">'/admin/blogengine/post/add/'</span>, {</td></tr><tr><td class="linenos" data-pseudo-content="197"></td><td>            <span class="hljs-string">'title'</span>: <span class="hljs-string">'My first post'</span>,</td></tr><tr><td class="linenos" data-pseudo-content="198"></td><td>            <span class="hljs-string">'text'</span>: <span class="hljs-string">'This is my first post'</span>,</td></tr><tr><td class="linenos" data-pseudo-content="199"></td><td>            <span class="hljs-string">'pub_date_0'</span>: <span class="hljs-string">'2013-12-28'</span>,</td></tr><tr><td class="linenos" data-pseudo-content="200"></td><td>            <span class="hljs-string">'pub_date_1'</span>: <span class="hljs-string">'22:00:04'</span>,</td></tr><tr><td class="linenos" data-pseudo-content="201"></td><td>            <span class="hljs-string">'slug'</span>: <span class="hljs-string">'my-first-post'</span>,</td></tr><tr><td class="linenos" data-pseudo-content="202"></td><td>            <span class="hljs-string">'site'</span>: <span class="hljs-string">'1'</span>,</td></tr><tr><td class="linenos" data-pseudo-content="203"></td><td>            <span class="hljs-string">'category'</span>: str(category.pk),</td></tr><tr><td class="linenos" data-pseudo-content="204"></td><td>            <span class="hljs-string">'tags'</span>: str(tag.pk)</td></tr><tr><td class="linenos" data-pseudo-content="205"></td><td>        },</td></tr><tr><td class="linenos" data-pseudo-content="206"></td><td>        follow=<span class="hljs-keyword">True</span></td></tr><tr><td class="linenos" data-pseudo-content="207"></td><td>        )</td></tr><tr><td class="linenos" data-pseudo-content="208"></td><td>        self.assertEquals(response.status_code, <span class="hljs-number">200</span>)</td></tr><tr><td class="linenos" data-pseudo-content="209"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="210"></td><td>        <span class="hljs-comment"># Check added successfully</span></td></tr><tr><td class="linenos" data-pseudo-content="211"></td><td>        self.assertTrue(<span class="hljs-string">'added successfully'</span> <span class="hljs-keyword">in</span> response.content)</td></tr><tr><td class="linenos" data-pseudo-content="212"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="213"></td><td>        <span class="hljs-comment"># Check new post now in database</span></td></tr><tr><td class="linenos" data-pseudo-content="214"></td><td>        all_posts = Post.objects.all()</td></tr><tr><td class="linenos" data-pseudo-content="215"></td><td>        self.assertEquals(len(all_posts), <span class="hljs-number">1</span>)</td></tr><tr><td class="linenos" data-pseudo-content="216"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="217"></td><td>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_create_post_without_tag</span><span class="hljs-params">(self)</span>:</span></td></tr><tr><td class="linenos" data-pseudo-content="218"></td><td>        <span class="hljs-comment"># Create the category</span></td></tr><tr><td class="linenos" data-pseudo-content="219"></td><td>        category = CategoryFactory()</td></tr><tr><td class="linenos" data-pseudo-content="220"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="221"></td><td>        <span class="hljs-comment"># Log in</span></td></tr><tr><td class="linenos" data-pseudo-content="222"></td><td>        self.client.login(username=<span class="hljs-string">'bobsmith'</span>, password=<span class="hljs-string">"password"</span>)</td></tr><tr><td class="linenos" data-pseudo-content="223"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="224"></td><td>        <span class="hljs-comment"># Check response code</span></td></tr><tr><td class="linenos" data-pseudo-content="225"></td><td>        response = self.client.get(<span class="hljs-string">'/admin/blogengine/post/add/'</span>)</td></tr><tr><td class="linenos" data-pseudo-content="226"></td><td>        self.assertEquals(response.status_code, <span class="hljs-number">200</span>)</td></tr><tr><td class="linenos" data-pseudo-content="227"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="228"></td><td>        <span class="hljs-comment"># Create the new post</span></td></tr><tr><td class="linenos" data-pseudo-content="229"></td><td>        response = self.client.post(<span class="hljs-string">'/admin/blogengine/post/add/'</span>, {</td></tr><tr><td class="linenos" data-pseudo-content="230"></td><td>            <span class="hljs-string">'title'</span>: <span class="hljs-string">'My first post'</span>,</td></tr><tr><td class="linenos" data-pseudo-content="231"></td><td>            <span class="hljs-string">'text'</span>: <span class="hljs-string">'This is my first post'</span>,</td></tr><tr><td class="linenos" data-pseudo-content="232"></td><td>            <span class="hljs-string">'pub_date_0'</span>: <span class="hljs-string">'2013-12-28'</span>,</td></tr><tr><td class="linenos" data-pseudo-content="233"></td><td>            <span class="hljs-string">'pub_date_1'</span>: <span class="hljs-string">'22:00:04'</span>,</td></tr><tr><td class="linenos" data-pseudo-content="234"></td><td>            <span class="hljs-string">'slug'</span>: <span class="hljs-string">'my-first-post'</span>,</td></tr><tr><td class="linenos" data-pseudo-content="235"></td><td>            <span class="hljs-string">'site'</span>: <span class="hljs-string">'1'</span>,</td></tr><tr><td class="linenos" data-pseudo-content="236"></td><td>            <span class="hljs-string">'category'</span>: str(category.pk)</td></tr><tr><td class="linenos" data-pseudo-content="237"></td><td>        },</td></tr><tr><td class="linenos" data-pseudo-content="238"></td><td>        follow=<span class="hljs-keyword">True</span></td></tr><tr><td class="linenos" data-pseudo-content="239"></td><td>        )</td></tr><tr><td class="linenos" data-pseudo-content="240"></td><td>        self.assertEquals(response.status_code, <span class="hljs-number">200</span>)</td></tr><tr><td class="linenos" data-pseudo-content="241"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="242"></td><td>        <span class="hljs-comment"># Check added successfully</span></td></tr><tr><td class="linenos" data-pseudo-content="243"></td><td>        self.assertTrue(<span class="hljs-string">'added successfully'</span> <span class="hljs-keyword">in</span> response.content)</td></tr><tr><td class="linenos" data-pseudo-content="244"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="245"></td><td>        <span class="hljs-comment"># Check new post now in database</span></td></tr><tr><td class="linenos" data-pseudo-content="246"></td><td>        all_posts = Post.objects.all()</td></tr><tr><td class="linenos" data-pseudo-content="247"></td><td>        self.assertEquals(len(all_posts), <span class="hljs-number">1</span>)</td></tr><tr><td class="linenos" data-pseudo-content="248"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="249"></td><td>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_edit_post</span><span class="hljs-params">(self)</span>:</span></td></tr><tr><td class="linenos" data-pseudo-content="250"></td><td>        <span class="hljs-comment"># Create the post</span></td></tr><tr><td class="linenos" data-pseudo-content="251"></td><td>        post = PostFactory()</td></tr><tr><td class="linenos" data-pseudo-content="252"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="253"></td><td>        <span class="hljs-comment"># Create the category</span></td></tr><tr><td class="linenos" data-pseudo-content="254"></td><td>        category = CategoryFactory()</td></tr><tr><td class="linenos" data-pseudo-content="255"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="256"></td><td>        <span class="hljs-comment"># Create the tag</span></td></tr><tr><td class="linenos" data-pseudo-content="257"></td><td>        tag = TagFactory()</td></tr><tr><td class="linenos" data-pseudo-content="258"></td><td>        post.tags.add(tag)</td></tr><tr><td class="linenos" data-pseudo-content="259"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="260"></td><td>        <span class="hljs-comment"># Log in</span></td></tr><tr><td class="linenos" data-pseudo-content="261"></td><td>        self.client.login(username=<span class="hljs-string">'bobsmith'</span>, password=<span class="hljs-string">"password"</span>)</td></tr><tr><td class="linenos" data-pseudo-content="262"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="263"></td><td>        <span class="hljs-comment"># Edit the post</span></td></tr><tr><td class="linenos" data-pseudo-content="264"></td><td>        response = self.client.post(<span class="hljs-string">'/admin/blogengine/post/'</span> + str(post.pk) + <span class="hljs-string">'/'</span>, {</td></tr><tr><td class="linenos" data-pseudo-content="265"></td><td>            <span class="hljs-string">'title'</span>: <span class="hljs-string">'My second post'</span>,</td></tr><tr><td class="linenos" data-pseudo-content="266"></td><td>            <span class="hljs-string">'text'</span>: <span class="hljs-string">'This is my second blog post'</span>,</td></tr><tr><td class="linenos" data-pseudo-content="267"></td><td>            <span class="hljs-string">'pub_date_0'</span>: <span class="hljs-string">'2013-12-28'</span>,</td></tr><tr><td class="linenos" data-pseudo-content="268"></td><td>            <span class="hljs-string">'pub_date_1'</span>: <span class="hljs-string">'22:00:04'</span>,</td></tr><tr><td class="linenos" data-pseudo-content="269"></td><td>            <span class="hljs-string">'slug'</span>: <span class="hljs-string">'my-second-post'</span>,</td></tr><tr><td class="linenos" data-pseudo-content="270"></td><td>            <span class="hljs-string">'site'</span>: <span class="hljs-string">'1'</span>,</td></tr><tr><td class="linenos" data-pseudo-content="271"></td><td>            <span class="hljs-string">'category'</span>: str(category.pk),</td></tr><tr><td class="linenos" data-pseudo-content="272"></td><td>            <span class="hljs-string">'tags'</span>: str(tag.pk)</td></tr><tr><td class="linenos" data-pseudo-content="273"></td><td>        },</td></tr><tr><td class="linenos" data-pseudo-content="274"></td><td>        follow=<span class="hljs-keyword">True</span></td></tr><tr><td class="linenos" data-pseudo-content="275"></td><td>        )</td></tr><tr><td class="linenos" data-pseudo-content="276"></td><td>        self.assertEquals(response.status_code, <span class="hljs-number">200</span>)</td></tr><tr><td class="linenos" data-pseudo-content="277"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="278"></td><td>        <span class="hljs-comment"># Check changed successfully</span></td></tr><tr><td class="linenos" data-pseudo-content="279"></td><td>        self.assertTrue(<span class="hljs-string">'changed successfully'</span> <span class="hljs-keyword">in</span> response.content)</td></tr><tr><td class="linenos" data-pseudo-content="280"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="281"></td><td>        <span class="hljs-comment"># Check post amended</span></td></tr><tr><td class="linenos" data-pseudo-content="282"></td><td>        all_posts = Post.objects.all()</td></tr><tr><td class="linenos" data-pseudo-content="283"></td><td>        self.assertEquals(len(all_posts), <span class="hljs-number">1</span>)</td></tr><tr><td class="linenos" data-pseudo-content="284"></td><td>        only_post = all_posts[<span class="hljs-number">0</span>]</td></tr><tr><td class="linenos" data-pseudo-content="285"></td><td>        self.assertEquals(only_post.title, <span class="hljs-string">'My second post'</span>)</td></tr><tr><td class="linenos" data-pseudo-content="286"></td><td>        self.assertEquals(only_post.text, <span class="hljs-string">'This is my second blog post'</span>)</td></tr><tr><td class="linenos" data-pseudo-content="287"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="288"></td><td>    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test_delete_post</span><span class="hljs-params">(self)</span>:</span></td></tr><tr><td class="linenos" data-pseudo-content="289"></td><td>        <span class="hljs-comment"># Create the post</span></td></tr><tr><td class="linenos" data-pseudo-content="290"></td><td>        post = PostFactory()</td></tr><tr><td class="linenos" data-pseudo-content="291"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="292"></td><td>        <span class="hljs-comment"># Create the tag</span></td></tr><tr><td class="linenos" data-pseudo-content="293"></td><td>        tag = TagFactory()</td></tr><tr><td class="linenos" data-pseudo-content="294"></td><td>        post.tags.add(tag)</td></tr><tr><td class="linenos" data-pseudo-content="295"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="296"></td><td>        <span class="hljs-comment"># Check new post saved</span></td></tr><tr><td class="linenos" data-pseudo-content="297"></td><td>        all_posts = Post.objects.all()</td></tr><tr><td class="linenos" data-pseudo-content="298"></td><td>        self.assertEquals(len(all_posts), <span class="hljs-number">1</span>)</td></tr><tr><td class="linenos" data-pseudo-content="299"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="300"></td><td>        <span class="hljs-comment"># Log in</span></td></tr><tr><td class="linenos" data-pseudo-content="301"></td><td>        self.client.login(username=<span class="hljs-string">'bobsmith'</span>, password=<span class="hljs-string">"password"</span>)</td></tr><tr><td class="linenos" data-pseudo-content="302"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="303"></td><td>        <span class="hljs-comment"># Delete the post</span></td></tr><tr><td class="linenos" data-pseudo-content="304"></td><td>        response = self.client.post(<span class="hljs-string">'/admin/blogengine/post/'</span> + str(post.pk) + <span class="hljs-string">'/delete/'</span>, {</td></tr><tr><td class="linenos" data-pseudo-content="305"></td><td>            <span class="hljs-string">'post'</span>: <span class="hljs-string">'yes'</span></td></tr><tr><td class="linenos" data-pseudo-content="306"></td><td>        }, follow=<span class="hljs-keyword">True</span>)</td></tr><tr><td class="linenos" data-pseudo-content="307"></td><td>        self.assertEquals(response.status_code, <span class="hljs-number">200</span>)</td></tr><tr><td class="linenos" data-pseudo-content="308"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="309"></td><td>        <span class="hljs-comment"># Check deleted successfully</span></td></tr><tr><td class="linenos" data-pseudo-content="310"></td><td>        self.assertTrue(<span class="hljs-string">'deleted successfully'</span> <span class="hljs-keyword">in</span> response.content)</td></tr><tr><td class="linenos" data-pseudo-content="311"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="312"></td><td>        <span class="hljs-comment"># Check post deleted</span></td></tr><tr><td class="linenos" data-pseudo-content="313"></td><td>        all_posts = Post.objects.all()</td></tr><tr><td class="linenos" data-pseudo-content="314"></td><td>        self.assertEquals(len(all_posts), <span class="hljs-number">0</span>)</td></tr></table></code></pre><p>There are two main issues here. The first is that when we try to edit or delete an existing item, or refer to it when creating something else, we can no longer rely on the number representing the primary key being set to 1. So we need to specifically obtain this, rather than hard-coding it to 1. Therefore, whenever we pass through a number to represent an item (with the exception of the site, but including tags, categories and posts), we need to instead fetch its primary key and return it. So, above where we try to delete a post, we replace <code>1</code> with <code>str(post.pk)</code>. This will solve a lot of the problems. As there’s a lot of them, I won’t go through each one, but you can see the entire class above for reference, and if you’ve followed along so far, you shouldn’t have any problems.</p><p>The other issue we need to fix is the login and logout tests. We simply add <code>follow=True</code> to these to ensure that the test client follows the redirects.</p><p>Let’s run our tests to make sure they pass:</p><pre><code class="hljs lang-bash"><table><tr><td class="linenos" data-pseudo-content="1"></td><td>$ python manage.py jenkins</td></tr><tr><td class="linenos" data-pseudo-content="2"></td><td>Creating <span class="hljs-built_in">test</span> database <span class="hljs-keyword">for</span> <span class="hljs-built_in">alias</span> <span class="hljs-string">'default'</span>...</td></tr><tr><td class="linenos" data-pseudo-content="3"></td><td>.............................</td></tr><tr><td class="linenos" data-pseudo-content="4"></td><td>----------------------------------------------------------------------</td></tr><tr><td class="linenos" data-pseudo-content="5"></td><td>Ran 29 tests <span class="hljs-keyword">in</span> 8.210s</td></tr><tr><td class="linenos" data-pseudo-content="6"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="7"></td><td>OK</td></tr><tr><td class="linenos" data-pseudo-content="8"></td><td>Destroying <span class="hljs-built_in">test</span> database <span class="hljs-keyword">for</span> <span class="hljs-built_in">alias</span> <span class="hljs-string">'default'</span>...</td></tr></table></code></pre><p>With that done, you can commit your changes:</p><pre><code class="hljs lang-bash"><table><tr><td class="linenos" data-pseudo-content="1"></td><td>$ git add blogengine/tests.py</td></tr><tr><td class="linenos" data-pseudo-content="2"></td><td>$ git commit -m <span class="hljs-string">'Fixed broken tests'</span></td></tr></table></code></pre><p>Don’t forget to deploy your changes:</p><pre><code class="hljs lang-bash singleline">$ fab deploy</code></pre><p>Our blog has now been happily migrated over to Django 1.7!</p><ul class="categorylist"><li><a href="/blog/categories/tdd/">tdd</a></li><li><a href="/blog/categories/python/">python</a></li><li><a href="/blog/categories/django/">django</a></li><li><a href="/blog/categories/django-blog-tutorial/">django-blog-tutorial</a></li></ul><div class="addthis_sharing_toolbox"></div><section class="comments"><div id="disqus_thread"></div><script>var disqus_config = function () {
                        this.page.url = "https://matthewdaly.co.uk/blog/2014/09/28/django-blog-tutorial-the-next-generation-part-9/";
                        this.page.identifier = "https://matthewdaly.co.uk/blog/2014/09/28/django-blog-tutorial-the-next-generation-part-9/";
                     };
                  (function() { // DON'T EDIT BELOW THIS LINE
                     var d = document, s = d.createElement('script');
                     s.src = 'https://matthewdaly.disqus.com/embed.js';
                     s.setAttribute('data-timestamp', +new Date());
                     (d.head || d.body).appendChild(s);
                  })();</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></section></article></div><div class="col-md-4"><h1>Recent Posts</h1><p><a href="/blog/2017/11/06/catching-debug-statements-in-php/">Catching Debug Statements in PHP</a></p><p><a href="/blog/2017/10/29/an-azure-filesystem-integration-for-laravel/">An Azure Filesystem Integration for Laravel</a></p><p><a href="/blog/2017/10/20/using-phpiredis-with-laravel/">Using Phpiredis With Laravel</a></p><p><a href="/blog/2017/10/03/simple-fuzzy-search-with-laravel-and-postgresql/">Simple Fuzzy Search With Laravel and Postgresql</a></p><p><a href="/blog/2017/09/25/a-generic-php-sms-library/">A Generic PHP SMS Library</a></p><section><h2>About me</h2><p>I'm a web and mobile app developer based in Norfolk. My skillset includes Python, PHP and Javascript, and I have extensive experience working with CodeIgniter, Laravel, Django, Phonegap and Angular.js.</p></section><section id="links"><h2>Links</h2><a href="https://github.com/matthewbdaly" rel="me">GitHub</a> <a href="https://twitter.com/MattBD" rel="me">Twitter</a> <a href="http://stackoverflow.com/users/63717/matthew-daly">Stack Overflow</a></section></div></div><div class="row"><div class="col-md-12"><ul class="pager"><li><a href="/blog/2014/09/28/changing-date-format-from-dd-slash-mm-slash-yyyy-to-yyyy-mm-dd-in-vim/"><span class="glyphicon glyphicon-chevron-left"></span> Changing Date Format from DD/MM/YYYY to YYYY-MM-DD in Vim</a></li><li><a href="/blog/2014/10/05/introducing-generator-simple-static-blog/">Introducing Generator-simple-static-blog <span class="glyphicon glyphicon-chevron-right"></span></a></li></ul></div></div></div><footer><div class="container footercontainer"><div class="col-md-12"><p class="copyright">Copyright &copy; Matthew Daly 2017.</p></div></div></footer><script type="text/javascript" src="/static/js/all.min.js"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
            function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
            e=o.createElement(i);r=o.getElementsByTagName(i)[0];
            e.src='//www.google-analytics.com/analytics.js';
            r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
            ga('create','UA-17043630-1');ga('send','pageview');</script><script id="dsq-count-scr" src="//matthewdaly.disqus.com/count.js" async></script></body></html>