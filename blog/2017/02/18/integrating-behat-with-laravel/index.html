<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="theme-color" content="#252525"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=0"><meta name="description" content="I&#x27;m a web developer in Norfolk. This is my blog..."><meta name="keywords" content="php,laravel,behat,tdd,bdd,testing"><link rel="amphtml" href="https://matthewdaly.co.uk/blog/2017/02/18/integrating-behat-with-laravel/amp/"><meta http-equiv="Content-Security-Policy" content="default-src 'self'; child-src 'none'; frame-src disqus.com *.addthis.com; object-src 'none'; font-src 'self' fonts.google-apis.com fonts.gstatic.com; style-src 'self' fonts.googleapis.com *.addthis.com google-analytics.com *.disquscdn.com *.disqus.com 'unsafe-inline'; script-src 'self' localhost:* *.addthis.com *.google-analytics.com *.disquscdn.com *.disqus.com disqus.com *.addthisedge.com graph.facebook.com 'unsafe-inline' 'unsafe-eval'; connect-src 'self' ws://localhost:*; img-src 'self' *.google-analytics.com *.disquscdn.com *.disqus.com stats.g.doubleclick.net"><link rel="canonical" href="https://matthewdaly.co.uk/blog/2017/02/18/integrating-behat-with-laravel/"><link href="/opensearch.xml" rel="search" title="Matthew Daly's Blog Search" type="application/opensearchdescription+xml"><link href="/favicon.ico" rel="icon"><link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="manifest" href="/manifest.json"><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=PT+Serif" media="all"><link rel="stylesheet" type="text/css" href="/static/css/style.min.css" media="all"><link rel="alternate" type="application/rss+xml" title="Matthew Daly&#x27;s Blog - feed" href="/rss.xml"><link rel="alternate" type="application/atom+xml" title="Matthew Daly&#x27;s Blog - feed" href="/atom.xml"><link rel="pingback" href="https://webmention.io/matthewdaly.co.uk/xmlrpc"><link rel="webmention" href="https://webmention.io/matthewdaly.co.uk/webmention"><title>Integrating Behat With Laravel - Matthew Daly&#x27;s Blog</title></head><body><script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=MattBD" async="async"></script><header><div class="container headercontainer"><div class="jumbotron"><h1><a href="/">Matthew Daly&#x27;s Blog</a></h1><h2>I&#x27;m a web developer in Norfolk. This is my blog...</h2></div></div><div class="container headercontainer"><nav class="navbar navbar-inverse navbar-static-top"><div class="navbar-header"><button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#header-nav"><span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button><div class="collapse navbar-collapse" id="header-nav"><ul class="nav navbar-nav"><li><a href="/">Home</a></li><li><a href="/blog/archives/">Archives</a></li><li><a href="/about/">About</a></li><li><a href="/rss.xml">RSS</a></li></ul><form action="https://www.google.com/search" method="GET" name="searchForm" id="searchForm" enctype="application/x-www-form-urlencoded" class="navbar-form navbar-right"><div class="form-group"><input type="hidden" id="sitesearch" value="matthewdaly.co.uk"> <input id="search" type="search" name="q" placeholder="Search..." maxlength="200" autocomplete="off" class="form-control"><ul class="searchresults"></ul></div></form></div></div></nav></div></header><div id="mainbody" class="container"><div class="row"><div class="col-md-8"><article class="post"><p class="date">18th February 2017 9:25 pm</p><h1>Integrating Behat With Laravel</h1><p>The Gherkin format used by tools like Cucumber is a really great way of specifying how your application will work. It’s easy for even non-technical stakeholders to understand, it makes it natural to break your tests into easily reusable steps, and it encourages you to think about the application from an end-user’s perspective. It’s also one of the easiest ways to get started writing automated tests when you first start out - it’s much more intuitive to a junior developer than lower-level unit tests, and is easier to add to a legacy project that may not have been built with testability in mind - if you can drive a browser, you can test it.</p><p><a href="http://behat.org/en/latest/">Behat</a> is a PHP equivalent. Combined with <a href="http://mink.behat.org/en/latest/">Mink</a>, it allows for easy automated acceptance tests of a PHP application. However, out of the box it doesn’t integrate well with Laravel. There is <a href="https://github.com/laracasts/Behat-Laravel-Extension">Jeffrey Way’s Behat Laravel extension</a>, but it doesn’t seem to be actively maintained and seems to be overkill for this purpose. I wanted something that I could use to run integration tests using PHPUnit’s assertions and Laravel’s testing utilities, and crucially, I wanted to do so as quickly as possible. That meant running a web server and using an automated web browser wasn’t an option. Also, I often work on REST API’s, and browser testing isn’t appropriate for those - in API tests I’m more interested in setting up the fixtures, making a single request, and verifying that it does what it’s meant to do, as quickly as possible.</p><p>As it turns out, integrating Behat and Laravel isn’t that hard. When using Behat, your <code>FeatureContext.php</code> file must implement the <code>Behat\Behat\Context\Context</code> interface, but as this interface does not implement any methods, you can extend any existing class and declare that it implements that interface. That means we can just extend the existing <code>Tests\TestCase</code> class in Laravel 5.4 and gain access to all the same testing utilities we have in our regular Laravel tests.</p><p>Then, in the constructor we can set environment variables using <code>putenv()</code> so that we can set it up to use an in-memory SQLite database for faster tests. We also use the <code>@BeforeScenario</code> hook to migrate the database before each scenario, and the <code>@AfterScenario</code> hook to roll it back afterwards.</p><p>Here’s the finished example:</p><pre><code class="hljs lang-php"><table><tr><td class="linenos" data-pseudo-content="1"></td><td><span class="hljs-meta">&lt;?php</span></td></tr><tr><td class="linenos" data-pseudo-content="2"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="3"></td><td><span class="hljs-keyword">use</span> <span class="hljs-title">Behat</span>\<span class="hljs-title">Behat</span>\<span class="hljs-title">Context</span>\<span class="hljs-title">Context</span>;</td></tr><tr><td class="linenos" data-pseudo-content="4"></td><td><span class="hljs-keyword">use</span> <span class="hljs-title">Behat</span>\<span class="hljs-title">Gherkin</span>\<span class="hljs-title">Node</span>\<span class="hljs-title">PyStringNode</span>;</td></tr><tr><td class="linenos" data-pseudo-content="5"></td><td><span class="hljs-keyword">use</span> <span class="hljs-title">Behat</span>\<span class="hljs-title">Gherkin</span>\<span class="hljs-title">Node</span>\<span class="hljs-title">TableNode</span>;</td></tr><tr><td class="linenos" data-pseudo-content="6"></td><td><span class="hljs-keyword">use</span> <span class="hljs-title">Tests</span>\<span class="hljs-title">TestCase</span>;</td></tr><tr><td class="linenos" data-pseudo-content="7"></td><td><span class="hljs-keyword">use</span> <span class="hljs-title">Behat</span>\<span class="hljs-title">Behat</span>\<span class="hljs-title">Tester</span>\<span class="hljs-title">Exception</span>\<span class="hljs-title">PendingException</span>;</td></tr><tr><td class="linenos" data-pseudo-content="8"></td><td><span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Foundation</span>\<span class="hljs-title">Testing</span>\<span class="hljs-title">DatabaseMigrations</span>;</td></tr><tr><td class="linenos" data-pseudo-content="9"></td><td><span class="hljs-keyword">use</span> <span class="hljs-title">App</span>\<span class="hljs-title">User</span>;</td></tr><tr><td class="linenos" data-pseudo-content="10"></td><td><span class="hljs-keyword">use</span> <span class="hljs-title">Behat</span>\<span class="hljs-title">Behat</span>\<span class="hljs-title">Hook</span>\<span class="hljs-title">Scope</span>\<span class="hljs-title">BeforeScenarioScope</span>;</td></tr><tr><td class="linenos" data-pseudo-content="11"></td><td><span class="hljs-keyword">use</span> <span class="hljs-title">Behat</span>\<span class="hljs-title">Behat</span>\<span class="hljs-title">Hook</span>\<span class="hljs-title">Scope</span>\<span class="hljs-title">AfterScenarioScope</span>;</td></tr><tr><td class="linenos" data-pseudo-content="12"></td><td><span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Contracts</span>\<span class="hljs-title">Console</span>\<span class="hljs-title">Kernel</span>;</td></tr><tr><td class="linenos" data-pseudo-content="13"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="14"></td><td><span class="hljs-comment">/**</span></td></tr><tr><td class="linenos" data-pseudo-content="15"></td><td> * Defines application features from the specific context.</td></tr><tr><td class="linenos" data-pseudo-content="16"></td><td> */</td></tr><tr><td class="linenos" data-pseudo-content="17"></td><td><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">FeatureContext</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">TestCase</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">Context</span></span></td></tr><tr><td class="linenos" data-pseudo-content="18"></td><td>{</td></tr><tr><td class="linenos" data-pseudo-content="19"></td><td>    <span class="hljs-keyword">use</span> <span class="hljs-title">DatabaseMigrations</span>;</td></tr><tr><td class="linenos" data-pseudo-content="20"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="21"></td><td>    <span class="hljs-keyword">protected</span> $content;</td></tr><tr><td class="linenos" data-pseudo-content="22"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="23"></td><td>    <span class="hljs-comment">/**</span></td></tr><tr><td class="linenos" data-pseudo-content="24"></td><td>     * Initializes context.</td></tr><tr><td class="linenos" data-pseudo-content="25"></td><td>     *</td></tr><tr><td class="linenos" data-pseudo-content="26"></td><td>     * Every scenario gets its own context instance.</td></tr><tr><td class="linenos" data-pseudo-content="27"></td><td>     * You can also pass arbitrary arguments to the</td></tr><tr><td class="linenos" data-pseudo-content="28"></td><td>     * context constructor through behat.yml.</td></tr><tr><td class="linenos" data-pseudo-content="29"></td><td>     */</td></tr><tr><td class="linenos" data-pseudo-content="30"></td><td>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">__construct</span><span class="hljs-params">()</span></span></td></tr><tr><td class="linenos" data-pseudo-content="31"></td><td>    {</td></tr><tr><td class="linenos" data-pseudo-content="32"></td><td>        putenv(<span class="hljs-string">'DB_CONNECTION=sqlite'</span>);</td></tr><tr><td class="linenos" data-pseudo-content="33"></td><td>        putenv(<span class="hljs-string">'DB_DATABASE=:memory:'</span>);</td></tr><tr><td class="linenos" data-pseudo-content="34"></td><td>        <span class="hljs-keyword">parent</span>::setUp();</td></tr><tr><td class="linenos" data-pseudo-content="35"></td><td>    }</td></tr><tr><td class="linenos" data-pseudo-content="36"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="37"></td><td>    <span class="hljs-comment">/** <span class="hljs-doctag">@BeforeScenario</span> */</span></td></tr><tr><td class="linenos" data-pseudo-content="38"></td><td>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">before</span><span class="hljs-params">(BeforeScenarioScope $scope)</span></span></td></tr><tr><td class="linenos" data-pseudo-content="39"></td><td>    {</td></tr><tr><td class="linenos" data-pseudo-content="40"></td><td>        <span class="hljs-keyword">$this</span>-&gt;artisan(<span class="hljs-string">'migrate'</span>);</td></tr><tr><td class="linenos" data-pseudo-content="41"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="42"></td><td>        <span class="hljs-keyword">$this</span>-&gt;app[Kernel::class]-&gt;setArtisan(<span class="hljs-keyword">null</span>);</td></tr><tr><td class="linenos" data-pseudo-content="43"></td><td>    }</td></tr><tr><td class="linenos" data-pseudo-content="44"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="45"></td><td>    <span class="hljs-comment">/** <span class="hljs-doctag">@AfterScenario</span> */</span></td></tr><tr><td class="linenos" data-pseudo-content="46"></td><td>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">after</span><span class="hljs-params">(AfterScenarioScope $scope)</span></span></td></tr><tr><td class="linenos" data-pseudo-content="47"></td><td>    {</td></tr><tr><td class="linenos" data-pseudo-content="48"></td><td>        <span class="hljs-keyword">$this</span>-&gt;artisan(<span class="hljs-string">'migrate:rollback'</span>);</td></tr><tr><td class="linenos" data-pseudo-content="49"></td><td>    }</td></tr><tr><td class="linenos" data-pseudo-content="50"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="51"></td><td>    <span class="hljs-comment">/**</span></td></tr><tr><td class="linenos" data-pseudo-content="52"></td><td>     * <span class="hljs-doctag">@Given</span> I visit the path :path</td></tr><tr><td class="linenos" data-pseudo-content="53"></td><td>     */</td></tr><tr><td class="linenos" data-pseudo-content="54"></td><td>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">iVisitThePath</span><span class="hljs-params">($path)</span></span></td></tr><tr><td class="linenos" data-pseudo-content="55"></td><td>    {</td></tr><tr><td class="linenos" data-pseudo-content="56"></td><td>        $response = <span class="hljs-keyword">$this</span>-&gt;get(<span class="hljs-string">'/'</span>);</td></tr><tr><td class="linenos" data-pseudo-content="57"></td><td>        <span class="hljs-keyword">$this</span>-&gt;assertEquals(<span class="hljs-number">200</span>, $response-&gt;getStatusCode());</td></tr><tr><td class="linenos" data-pseudo-content="58"></td><td>        <span class="hljs-keyword">$this</span>-&gt;content = $response-&gt;getContent();</td></tr><tr><td class="linenos" data-pseudo-content="59"></td><td>    }</td></tr><tr><td class="linenos" data-pseudo-content="60"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="61"></td><td>    <span class="hljs-comment">/**</span></td></tr><tr><td class="linenos" data-pseudo-content="62"></td><td>     * <span class="hljs-doctag">@Then</span> I should see the text :text</td></tr><tr><td class="linenos" data-pseudo-content="63"></td><td>     */</td></tr><tr><td class="linenos" data-pseudo-content="64"></td><td>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">iShouldSeeTheText</span><span class="hljs-params">($text)</span></span></td></tr><tr><td class="linenos" data-pseudo-content="65"></td><td>    {</td></tr><tr><td class="linenos" data-pseudo-content="66"></td><td>        <span class="hljs-keyword">$this</span>-&gt;assertContains($text, <span class="hljs-keyword">$this</span>-&gt;content);</td></tr><tr><td class="linenos" data-pseudo-content="67"></td><td>    }</td></tr><tr><td class="linenos" data-pseudo-content="68"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="69"></td><td>    <span class="hljs-comment">/**</span></td></tr><tr><td class="linenos" data-pseudo-content="70"></td><td>     * <span class="hljs-doctag">@Given</span> a user called :user exists</td></tr><tr><td class="linenos" data-pseudo-content="71"></td><td>     */</td></tr><tr><td class="linenos" data-pseudo-content="72"></td><td>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">aUserCalledExists</span><span class="hljs-params">($user)</span></span></td></tr><tr><td class="linenos" data-pseudo-content="73"></td><td>    {</td></tr><tr><td class="linenos" data-pseudo-content="74"></td><td>        $user = factory(App\User::class)-&gt;create([</td></tr><tr><td class="linenos" data-pseudo-content="75"></td><td>            <span class="hljs-string">'name'</span> =&gt; $user,</td></tr><tr><td class="linenos" data-pseudo-content="76"></td><td>        ]);</td></tr><tr><td class="linenos" data-pseudo-content="77"></td><td>    }</td></tr><tr><td class="linenos" data-pseudo-content="78"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="79"></td><td>    <span class="hljs-comment">/**</span></td></tr><tr><td class="linenos" data-pseudo-content="80"></td><td>     * <span class="hljs-doctag">@Given</span> I am logged in as :user</td></tr><tr><td class="linenos" data-pseudo-content="81"></td><td>     */</td></tr><tr><td class="linenos" data-pseudo-content="82"></td><td>    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">iAmLoggedInAs</span><span class="hljs-params">($user)</span></span></td></tr><tr><td class="linenos" data-pseudo-content="83"></td><td>    {</td></tr><tr><td class="linenos" data-pseudo-content="84"></td><td>        $user = User::where(<span class="hljs-string">'name'</span>, $user)-&gt;first();</td></tr><tr><td class="linenos" data-pseudo-content="85"></td><td>        <span class="hljs-keyword">$this</span>-&gt;be($user);</td></tr><tr><td class="linenos" data-pseudo-content="86"></td><td>    }</td></tr><tr><td class="linenos" data-pseudo-content="87"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="88"></td><td>}</td></tr></table></code></pre><p>Note that I’ve added a few basic example methods for our tests. As you can see, we can call the same methods we normally use in Laravel tests to make assertions and HTTP requests. If you’re using Dusk, you can also call that in the same way you usually would.</p><p>We might then write the following feature file to demonstrate our application at work:</p><pre><code class="hljs lang-gherkin"><table><tr><td class="linenos" data-pseudo-content="1"></td><td><span class="hljs-keyword">Feature</span>: Login</td></tr><tr><td class="linenos" data-pseudo-content="2"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="3"></td><td>    <span class="hljs-keyword">Background</span>:</td></tr><tr><td class="linenos" data-pseudo-content="4"></td><td>        <span class="hljs-keyword">Given</span> a user called <span class="hljs-string">"Alan"</span> exists</td></tr><tr><td class="linenos" data-pseudo-content="5"></td><td>        <span class="hljs-keyword">And</span> a user called <span class="hljs-string">"Bob"</span> exists</td></tr><tr><td class="linenos" data-pseudo-content="6"></td><td>        <span class="hljs-keyword">And</span> a user called <span class="hljs-string">"Clare"</span> exists</td></tr><tr><td class="linenos" data-pseudo-content="7"></td><td>        <span class="hljs-keyword">And</span> a user called <span class="hljs-string">"Derek"</span> exists</td></tr><tr><td class="linenos" data-pseudo-content="8"></td><td>        <span class="hljs-keyword">And</span> a user called <span class="hljs-string">"Eric"</span> exists</td></tr><tr><td class="linenos" data-pseudo-content="9"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="10"></td><td>    <span class="hljs-keyword">Scenario</span>: Log in as Alan</td></tr><tr><td class="linenos" data-pseudo-content="11"></td><td>        <span class="hljs-keyword">Given</span> I am logged in as <span class="hljs-string">"Alan"</span></td></tr><tr><td class="linenos" data-pseudo-content="12"></td><td>        <span class="hljs-keyword">And</span> I visit the path <span class="hljs-string">"/"</span></td></tr><tr><td class="linenos" data-pseudo-content="13"></td><td>        <span class="hljs-keyword">Then</span> I should see the text <span class="hljs-string">"Laravel"</span></td></tr><tr><td class="linenos" data-pseudo-content="14"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="15"></td><td>    <span class="hljs-keyword">Scenario</span>: Log in as Bob</td></tr><tr><td class="linenos" data-pseudo-content="16"></td><td>        <span class="hljs-keyword">Given</span> I am logged in as <span class="hljs-string">"Bob"</span></td></tr><tr><td class="linenos" data-pseudo-content="17"></td><td>        <span class="hljs-keyword">And</span> I visit the path <span class="hljs-string">"/"</span></td></tr><tr><td class="linenos" data-pseudo-content="18"></td><td>        <span class="hljs-keyword">Then</span> I should see the text <span class="hljs-string">"Laravel"</span></td></tr><tr><td class="linenos" data-pseudo-content="19"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="20"></td><td>    <span class="hljs-keyword">Scenario</span>: Log in as Clare</td></tr><tr><td class="linenos" data-pseudo-content="21"></td><td>        <span class="hljs-keyword">Given</span> I am logged in as <span class="hljs-string">"Clare"</span></td></tr><tr><td class="linenos" data-pseudo-content="22"></td><td>        <span class="hljs-keyword">And</span> I visit the path <span class="hljs-string">"/"</span></td></tr><tr><td class="linenos" data-pseudo-content="23"></td><td>        <span class="hljs-keyword">Then</span> I should see the text <span class="hljs-string">"Laravel"</span></td></tr><tr><td class="linenos" data-pseudo-content="24"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="25"></td><td>    <span class="hljs-keyword">Scenario</span>: Log in as Derek</td></tr><tr><td class="linenos" data-pseudo-content="26"></td><td>        <span class="hljs-keyword">Given</span> I am logged in as <span class="hljs-string">"Derek"</span></td></tr><tr><td class="linenos" data-pseudo-content="27"></td><td>        <span class="hljs-keyword">And</span> I visit the path <span class="hljs-string">"/"</span></td></tr><tr><td class="linenos" data-pseudo-content="28"></td><td>        <span class="hljs-keyword">Then</span> I should see the text <span class="hljs-string">"Laravel"</span></td></tr><tr><td class="linenos" data-pseudo-content="29"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="30"></td><td>    <span class="hljs-keyword">Scenario</span>: Log in as Eric</td></tr><tr><td class="linenos" data-pseudo-content="31"></td><td>        <span class="hljs-keyword">Given</span> I am logged in as <span class="hljs-string">"Eric"</span></td></tr><tr><td class="linenos" data-pseudo-content="32"></td><td>        <span class="hljs-keyword">And</span> I visit the path <span class="hljs-string">"/"</span></td></tr><tr><td class="linenos" data-pseudo-content="33"></td><td>        <span class="hljs-keyword">Then</span> I should see the text <span class="hljs-string">"Laravel"</span></td></tr></table></code></pre><p>We can then run these tests with <code>vendor/bin/behat</code>:</p><pre><code class="hljs lang-bash"><table><tr><td class="linenos" data-pseudo-content="1"></td><td>$ vendor/bin/behat </td></tr><tr><td class="linenos" data-pseudo-content="2"></td><td>Feature: Login</td></tr><tr><td class="linenos" data-pseudo-content="3"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="4"></td><td>  Background:                         <span class="hljs-comment"># features/auth.feature:3</span></td></tr><tr><td class="linenos" data-pseudo-content="5"></td><td>    Given a user called <span class="hljs-string">"Alan"</span> exists <span class="hljs-comment"># FeatureContext::aUserCalledExists()</span></td></tr><tr><td class="linenos" data-pseudo-content="6"></td><td>    And a user called <span class="hljs-string">"Bob"</span> exists    <span class="hljs-comment"># FeatureContext::aUserCalledExists()</span></td></tr><tr><td class="linenos" data-pseudo-content="7"></td><td>    And a user called <span class="hljs-string">"Clare"</span> exists  <span class="hljs-comment"># FeatureContext::aUserCalledExists()</span></td></tr><tr><td class="linenos" data-pseudo-content="8"></td><td>    And a user called <span class="hljs-string">"Derek"</span> exists  <span class="hljs-comment"># FeatureContext::aUserCalledExists()</span></td></tr><tr><td class="linenos" data-pseudo-content="9"></td><td>    And a user called <span class="hljs-string">"Eric"</span> exists   <span class="hljs-comment"># FeatureContext::aUserCalledExists()</span></td></tr><tr><td class="linenos" data-pseudo-content="10"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="11"></td><td>  Scenario: Log <span class="hljs-keyword">in</span> as Alan               <span class="hljs-comment"># features/auth.feature:10</span></td></tr><tr><td class="linenos" data-pseudo-content="12"></td><td>    Given I am logged <span class="hljs-keyword">in</span> as <span class="hljs-string">"Alan"</span>       <span class="hljs-comment"># FeatureContext::iAmLoggedInAs()</span></td></tr><tr><td class="linenos" data-pseudo-content="13"></td><td>    And I visit the path <span class="hljs-string">"/"</span>             <span class="hljs-comment"># FeatureContext::iVisitThePath()</span></td></tr><tr><td class="linenos" data-pseudo-content="14"></td><td>    Then I should see the text <span class="hljs-string">"Laravel"</span> <span class="hljs-comment"># FeatureContext::iShouldSeeTheText()</span></td></tr><tr><td class="linenos" data-pseudo-content="15"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="16"></td><td>  Scenario: Log <span class="hljs-keyword">in</span> as Bob                <span class="hljs-comment"># features/auth.feature:15</span></td></tr><tr><td class="linenos" data-pseudo-content="17"></td><td>    Given I am logged <span class="hljs-keyword">in</span> as <span class="hljs-string">"Bob"</span>        <span class="hljs-comment"># FeatureContext::iAmLoggedInAs()</span></td></tr><tr><td class="linenos" data-pseudo-content="18"></td><td>    And I visit the path <span class="hljs-string">"/"</span>             <span class="hljs-comment"># FeatureContext::iVisitThePath()</span></td></tr><tr><td class="linenos" data-pseudo-content="19"></td><td>    Then I should see the text <span class="hljs-string">"Laravel"</span> <span class="hljs-comment"># FeatureContext::iShouldSeeTheText()</span></td></tr><tr><td class="linenos" data-pseudo-content="20"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="21"></td><td>  Scenario: Log <span class="hljs-keyword">in</span> as Clare              <span class="hljs-comment"># features/auth.feature:20</span></td></tr><tr><td class="linenos" data-pseudo-content="22"></td><td>    Given I am logged <span class="hljs-keyword">in</span> as <span class="hljs-string">"Clare"</span>      <span class="hljs-comment"># FeatureContext::iAmLoggedInAs()</span></td></tr><tr><td class="linenos" data-pseudo-content="23"></td><td>    And I visit the path <span class="hljs-string">"/"</span>             <span class="hljs-comment"># FeatureContext::iVisitThePath()</span></td></tr><tr><td class="linenos" data-pseudo-content="24"></td><td>    Then I should see the text <span class="hljs-string">"Laravel"</span> <span class="hljs-comment"># FeatureContext::iShouldSeeTheText()</span></td></tr><tr><td class="linenos" data-pseudo-content="25"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="26"></td><td>  Scenario: Log <span class="hljs-keyword">in</span> as Derek              <span class="hljs-comment"># features/auth.feature:25</span></td></tr><tr><td class="linenos" data-pseudo-content="27"></td><td>    Given I am logged <span class="hljs-keyword">in</span> as <span class="hljs-string">"Derek"</span>      <span class="hljs-comment"># FeatureContext::iAmLoggedInAs()</span></td></tr><tr><td class="linenos" data-pseudo-content="28"></td><td>    And I visit the path <span class="hljs-string">"/"</span>             <span class="hljs-comment"># FeatureContext::iVisitThePath()</span></td></tr><tr><td class="linenos" data-pseudo-content="29"></td><td>    Then I should see the text <span class="hljs-string">"Laravel"</span> <span class="hljs-comment"># FeatureContext::iShouldSeeTheText()</span></td></tr><tr><td class="linenos" data-pseudo-content="30"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="31"></td><td>  Scenario: Log <span class="hljs-keyword">in</span> as Eric               <span class="hljs-comment"># features/auth.feature:30</span></td></tr><tr><td class="linenos" data-pseudo-content="32"></td><td>    Given I am logged <span class="hljs-keyword">in</span> as <span class="hljs-string">"Eric"</span>       <span class="hljs-comment"># FeatureContext::iAmLoggedInAs()</span></td></tr><tr><td class="linenos" data-pseudo-content="33"></td><td>    And I visit the path <span class="hljs-string">"/"</span>             <span class="hljs-comment"># FeatureContext::iVisitThePath()</span></td></tr><tr><td class="linenos" data-pseudo-content="34"></td><td>    Then I should see the text <span class="hljs-string">"Laravel"</span> <span class="hljs-comment"># FeatureContext::iShouldSeeTheText()</span></td></tr><tr><td class="linenos" data-pseudo-content="35"></td><td></td></tr><tr><td class="linenos" data-pseudo-content="36"></td><td>5 scenarios (5 passed)</td></tr><tr><td class="linenos" data-pseudo-content="37"></td><td>40 steps (40 passed)</td></tr><tr><td class="linenos" data-pseudo-content="38"></td><td>0m0.50s (19.87Mb)</td></tr></table></code></pre><p>Higher level tests can get very tedious if you’re not careful - you wind up setting up the same fixtures and making the same requests many times over. By using Behat in this way, not only are you writing your tests in a way that is easy to understand, but you’re also breaking it down into logical, repeatable steps, and by passing arguments in each step you limit the amount of repetition. It’s also fast if you aren’t running browser-based tests, making it particularly well-suited to API testing.</p><ul class="categorylist"><li><a href="/blog/categories/php/">php</a></li><li><a href="/blog/categories/laravel/">laravel</a></li><li><a href="/blog/categories/behat/">behat</a></li><li><a href="/blog/categories/tdd/">tdd</a></li><li><a href="/blog/categories/bdd/">bdd</a></li><li><a href="/blog/categories/testing/">testing</a></li></ul><div class="addthis_sharing_toolbox"></div><section class="comments"><div id="disqus_thread"></div><script>var disqus_config = function () {
                        this.page.url = "https://matthewdaly.co.uk/blog/2017/02/18/integrating-behat-with-laravel/";
                        this.page.identifier = "https://matthewdaly.co.uk/blog/2017/02/18/integrating-behat-with-laravel/";
                     };
                  (function() { // DON'T EDIT BELOW THIS LINE
                     var d = document, s = d.createElement('script');
                     s.src = 'https://matthewdaly.disqus.com/embed.js';
                     s.setAttribute('data-timestamp', +new Date());
                     (d.head || d.body).appendChild(s);
                  })();</script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript></section></article></div><div class="col-md-4"><h1>Recent Posts</h1><p><a href="/blog/2018/04/12/making-wordpress-less-shit/">Making Wordpress Less Shit</a></p><p><a href="/blog/2018/03/10/using-stored-procedures-in-your-web-app/">Using Stored Procedures in Your Web App</a></p><p><a href="/blog/2018/02/25/check-your-code-base-is-php-7-ready-with-php-compatibility/">Check Your Code Base Is PHP 7 Ready With PHP Compatibility</a></p><p><a href="/blog/2018/02/25/unit-testing-your-laravel-controllers/">Unit Testing Your Laravel Controllers</a></p><p><a href="/blog/2018/02/18/put-your-laravel-controllers-on-a-diet/">Put Your Laravel Controllers on a Diet</a></p><section><h2>About me</h2><p>I'm a web and mobile app developer based in Norfolk. My skillset includes Python, PHP and Javascript, and I have extensive experience working with CodeIgniter, Laravel, Django, Phonegap and Angular.js.</p></section><section id="links"><h2>Links</h2><a href="https://github.com/matthewbdaly" rel="me">GitHub</a> <a href="https://twitter.com/MattBD" rel="me">Twitter</a> <a href="http://stackoverflow.com/users/63717/matthew-daly">Stack Overflow</a></section></div></div><div class="row"><div class="col-md-12"><ul class="pager"><li><a href="/blog/2016/11/29/testing-laravel-middleware/"><span class="glyphicon glyphicon-chevron-left"></span> Testing Laravel Middleware</a></li><li><a href="/blog/2017/02/19/my-first-laravel-package/">My First Laravel Package <span class="glyphicon glyphicon-chevron-right"></span></a></li></ul></div></div></div><footer><div class="container footercontainer"><div class="col-md-12"><p class="copyright">Copyright &copy; Matthew Daly 2018.</p></div></div></footer><script type="text/javascript" src="/static/js/all.min.js"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=
            function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;
            e=o.createElement(i);r=o.getElementsByTagName(i)[0];
            e.src='//www.google-analytics.com/analytics.js';
            r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));
            ga('create','UA-17043630-1');ga('send','pageview');</script><script id="dsq-count-scr" src="//matthewdaly.disqus.com/count.js" async></script></body></html>